import{K as I,u as s}from"./index-2Uo9qjFZ.js";import{c as pt,p as ie,_ as oe,b as kt,E as Nt,m as At,N as Ut,y as se}from"./CGen-8GSN223x-BnRzQ8tt.js";const le=(t,e)=>({data:t,view:new DataView(t),cursor:0,scale:0,color_encoding:0,coord_range:0,width:0,height:0,colors_size:0,colors:[],doc:document.getElementById(e),elem:void 0,gradIndex:0}),ae=(t,e)=>{const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)},ce=t=>{let e=t;switch(t.coord_range&&(e=t.range),e){case 0:return 2;case 1:return 1;case 2:return 4}},lt=(t,e)=>{let r=t;if(t.coord_range&&(r=t.range),e==0){switch(r){case 0:return 65535;case 1:return 255;case 2:return 4294967295}return}return e},St=(t,e,r)=>{const n=new DataView(r);switch(t){case 0:return n.getUint16(e,!0);case 1:return n.getUint8(e);case 2:return n.getUint32(e,!0)}},vt=t=>{let e;switch(t.coord_range){case 0:e=t.view.getUint16(t.cursor,!0),t.cursor+=2;break;case 1:e=t.view.getUint8(t.cursor),t.cursor+=1;break;case 2:e=t.view.getUint32(t.cursor,!0),t.cursor+=4;break}return e},B=t=>{let e=0,r=0,n;for(;;){n=t.view.getUint8(t.cursor++);const i=(n&127)<<7*e;if(r|=i,(n&128)===0)break;++e}return r},de=(t,e)=>{const r=1<<t.scale;return e/r},G=t=>{const e=vt(t);return de(t,e)},k=t=>{const e=G(t),r=G(t);return{x:e,y:r}},ue=t=>{switch(t.color_encoding){case 2:{const e=[];return e.push(t.view.getFloat32(t.cursor,!0)),t.cursor+=4,e.push(t.view.getFloat32(t.cursor,!0)),t.cursor+=4,e.push(t.view.getFloat32(t.cursor,!0)),t.cursor+=4,e.push(t.view.getFloat32(t.cursor,!0)),t.cursor+=4,{r:e[0],g:e[1],b:e[2],a:e[3]}}case 1:{const e=t.view.getUint16(t.cursor,!0);return t.cursor+=2,{r:(e&31)/15,g:(e>>>5&63)/31,b:(e>>>11&31)/15,a:1}}case 0:{const e=[];return e.push(t.view.getUint8(t.cursor++)),e.push(t.view.getUint8(t.cursor++)),e.push(t.view.getUint8(t.cursor++)),e.push(t.view.getUint8(t.cursor++)),{r:e[0]/255,g:e[1]/255,b:e[2]/255,a:e[3]/255}}case 3:throw new Error("TinyVG: Custom color table not supported");default:throw new Error("TinyVG: Invalid color format")}},Tt=t=>{const e=k(t),r=k(t),n=B(t),i=B(t);return{point0:e,point1:r,color0:n,color1:i}},at=(t,e)=>{switch(e){case 0:return{kind:e,flat:B(t)};case 1:return{kind:e,linear:Tt(t)};case 2:return{kind:e,radial:Tt(t)};default:throw new Error("TinyVG: Invalid format parsing style")}},wt=(t,e)=>{const r=B(t)+1,n=at(t,e);return{size:r,style:n}},ot=(t,e)=>{const r=B(t)+1,n=at(t,e),i=G(t);return{size:r,style:n,line_width:i}},yt=(t,e)=>{let r=t.view.getUint8(t.cursor++);const n=(r&63)+1,i=at(t,e),o=at(t,r>>>6&3),l=G(t);return{size:n,fill_style:i,line_style:o,line_width:l}},et=(t,e)=>{let r,n,i,o,l="";i=k(t),l+=`M${i.x} ${i.y}`,r=i,n=i;for(let c=0;c<e;++c)switch(o=t.view.getUint8(t.cursor++),(o>>>4&1)!==0&&G(t),o&7){case 0:i=k(t),l+=` L${i.x} ${i.y}`,n=i;break;case 1:i.x=G(t),i.y=n.y,l+=` H${i.x}`,n=i;break;case 2:i.x=n.x,i.y=G(t),l+=` V${i.y}`,n=i;break;case 3:{const d=k(t),h=k(t),a=k(t);l+=` C${d.x} ${d.y} ${h.x} ${h.y} ${a.x} ${a.y}`,n=a}break;case 4:{o=t.view.getUint8(t.cursor++);const d=G(t);i=k(t),l+=` A${d} ${d} 0 ${o&1} ${1-(o>>>1&1)} ${i.x} ${i.y}`,n=i}break;case 5:{o=t.view.getUint8(t.cursor++);const d=G(t),h=G(t),a=G(t);i=k(t),l+=` A${d} ${h} ${a} ${o&1} ${1-(o>>>1&1)} ${i.x} ${i.y}`,n=i}break;case 6:l+=" Z",n=r;break;case 7:{const d=k(t),h=k(t);l+=` Q${d.x} ${d.y} ${h.x} ${h.y}`,n=h}break;default:throw new Error("TinyVG: Unrecognized command parsing path")}return l},ct=t=>{const e=k(t),r=G(t),n=G(t);return{x:e.x,y:e.y,width:r,height:n}},st=t=>{let e=t.toString(16);return e.length===1?"0"+e:e},nt=t=>({color:`#${st(t.r*255)}${st(t.g*255)}${st(t.b*255)}`,opacity:t.a}),U=(t,e)=>{if(t=document.createElementNS("http://www.w3.org/2000/svg",t),e)for(let r in e)t.setAttributeNS(null,r.replace(/[A-Z]/g,function(n,i,o,l){return"-"+n.toLowerCase()}),e[r]);return t},S=(t,e,r)=>{t.setAttributeNS(null,e,r)},fe=(t,e)=>{let r=t.doc.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs"),n;if(r.length==0?(n=U("defs"),t.doc.prepend(n)):n=r[0],e.kind===1){const i=U("linearGradient",{id:`TvgGradient${t.gradIndex+1}`,x1:e.linear.point0.x,y1:e.linear.point0.y,x2:e.linear.point1.x,y2:e.linear.point1.y});i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"spreadMethod","pad");let o=nt(t.colors[e.linear.color0]);const l=U("stop",{offset:"0%",stopColor:o.color});i.appendChild(l),o=nt(t.colors[e.linear.color1]);const c=U("stop",{offset:"100%",stopColor:o.color});return i.appendChild(c),n.appendChild(i),++t.gradIndex,i.getAttributeNS(null,"id")}else if(e.kind===2){const i=ae(e.radial.point0,e.radial.point1),o=U("radialGradient",{id:`TvgGradient${t.gradIndex+1}`,cx:e.radial.point0.x,cy:e.radial.point0.y,fx:e.radial.point0.x,fy:e.radial.point0.y,r:i});o.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),o.setAttributeNS(null,"spreadMethod","pad");let l=nt(t.colors[e.radial.color0]);const c=U("stop",{offset:"0%",stopColor:l.color,stopOpacity:l.opacity});o.appendChild(c),l=nt(t.colors[e.radial.color1]);const d=U("stop",{offset:"100%",stopColor:l.color,stopOpacity:l.opacity});return o.appendChild(d),n.appendChild(o),++t.gradIndex,o.getAttributeNS(null,"id")}else throw e.kind===0?new Error("TinyVG: attempt to pass flat style to create gradient"):new Error("TinyVG: attempt to pass an invalid style to create gradient")},V=(t,e,r)=>{if(e.kind===0){const n=nt(t.colors[e.flat]);r?(S(t.elem,"fill",n.color),S(t.elem,"fill-opacity",n.opacity)):(S(t.elem,"stroke",n.color),S(t.elem,"stroke-opacity",n.opacity))}else if(e.kind===1||e.kind===2){const n=fe(t,e);r?S(t.elem,"fill",`url(#${n})`):S(t.elem,"stroke",`url(#${n})`)}else throw new Error("TinyVG: attempt to apply invalid style")},he=(t,e,r)=>{let n=e;if(n===0)throw new Error("TinyVG: Invalid zero length filled rectangles entry");let i=ct(t),o=U("rect",i);t.doc.appendChild(o),t.elem=o,S(t.elem,"fill-rule","evenodd"),V(t,r,!0);const l={};for(l.fillRule="evenodd",r.kind!==0?l.fill=o.getAttributeNS(null,"fill"):(l.fill=o.getAttributeNS(null,"fill"),l.fillOpacity=o.getAttributeNS(null,"fill-opacity")),--n;n--;){i=ct(t);const c={...l,...i};o=U("rect",c),t.doc.appendChild(o),t.elem=o}},ge=(t,e,r,n,i)=>{let o=e;if(o===0)throw new Error("TinyVG: Invalid zero length line filled rectangles entry");i===0&&(i=.001);let l=ct(t),c=U("rect",l);t.doc.appendChild(c),t.elem=c,S(t.elem,"fill-rule","evenodd"),S(t.elem,"stroke-width",i),V(t,r,!0),V(t,n,!1);const d={};for(d.fillRule="evenodd",r.kind!==0?d.fill=c.getAttributeNS(null,"fill"):(d.fill=c.getAttributeNS(null,"fill"),d.fillOpacity=c.getAttributeNS(null,"fill-opacity")),n.kind!==0?d.stroke=c.getAttributeNS(null,"stroke"):(d.stroke=c.getAttributeNS(null,"stroke"),d.strokeOpacity=c.getAttributeNS(null,"stroke-opacity")),d.strokeWidth=i,--o;o--;){l=ct(t);const h={...d,...l};c=U("rect",h),t.doc.appendChild(c),t.elem=c}},pe=(t,e,r)=>{if(e===0)throw new Error("TinyVG: Invalid zero filled paths entry");const n={};n.fillRule="evenodd",n.strokeOpacity=0,n.strokeWidth=0;const i=[];for(let c=0;c<e;++c)i.push(B(t)+1);let o=U("path",n);t.doc.appendChild(o),t.elem=o,V(t,r,!0),r.kind!==0?n.fill=o.getAttributeNS(null,"fill"):(n.fill=o.getAttributeNS(null,"fill"),n.fillOpacity=o.getAttributeNS(null,"fill-opacity"));let l=et(t,i[0]);for(let c=1;c<e;++c)l+=` ${et(t,i[c])}`;S(o,"d",l)},we=(t,e,r,n)=>{if(e===0)throw new Error("TinyVG: Invalid zero line paths entry");n===0&&(n=.001);const i={},o=[];for(let d=0;d<e;++d)o.push(B(t)+1);let l=U("path",i);t.doc.appendChild(l),t.elem=l,S(t.elem,"fill-opacity",0),S(t.elem,"stroke-width",n),V(t,r,!1),r.kind!==0?i.stroke=l.getAttributeNS(null,"stroke"):(i.stroke=l.getAttributeNS(null,"stroke"),i.strokeOpacity=l.getAttributeNS(null,"stroke-opacity")),i.strokeWidth=n,i.fillOpacity=0;let c=et(t,o[0]);for(let d=1;d<e;++d)c+=` ${et(t,o[d])}`;S(l,"d",c)},ye=(t,e,r,n,i)=>{if(e===0)throw new Error("TinyVG: Invalid zero line filled paths entry");i===0&&(i=.001);const o={};o.fillRule="evenodd";const l=[];for(let h=0;h<e;++h)l.push(B(t)+1);let c=U("path",o);t.doc.appendChild(c),t.elem=c,V(t,r,!0),r.kind!==0?o.fill=c.getAttributeNS(null,"fill"):(o.fill=c.getAttributeNS(null,"fill"),o.fillOpacity=c.getAttributeNS(null,"fill-opacity")),V(t,n,!1),n.kind!==0?o.stroke=c.getAttributeNS(null,"stroke"):(o.stroke=c.getAttributeNS(null,"stroke"),o.strokeOpacity=c.getAttributeNS(null,"stroke-opacity")),o.strokeWidth=i,S(c,"stroke-width",i);let d=et(t,l[0]);for(let h=1;h<e;++h)d+=` ${et(t,l[h])}`;S(c,"d",d)},xe=(t,e,r)=>{if(e===0)throw new Error("TinyVG: Invalid zero polygon entry");let n=e,i="",o=k(t);for(i+=`${o.x},${o.y}`;--n;)o=k(t),i+=` ${o.x},${o.y}`;let l=U("polygon",{fillRule:"evenodd",points:i});t.doc.appendChild(l),t.elem=l,V(t,r,!0)},Et=(t,e,r,n,i)=>{if(e===0)throw new Error("TinyVG: Invalid zero polyline entry");n===0&&(n=.001);let o=e,l="",c=k(t);for(l+=`${c.x},${c.y}`;--o;)c=k(t),l+=` ${c.x},${c.y}`;let d=U(i?"polygon":"polyline",{points:l,lineWidth:n,fillOpacity:0});t.doc.appendChild(d),t.elem=d,V(t,r,!1)},me=(t,e,r,n,i,o)=>{if(e===0)throw new Error("TinyVG: Invalid zero line fill polyline entry");i===0&&(i=.001);let l=e,c="",d=k(t);for(c+=`${d.x},${d.y}`;--l;)d=k(t),c+=` ${d.x},${d.y}`;let h=U("polygon",{points:c,lineWidth:i,fillRule:"evenodd"});t.doc.appendChild(h),t.elem=h,V(t,r,!0),V(t,n,!1)},ve=(t,e,r,n)=>{if(e===0)throw new Error("TinyVG: Invalid zero lines entry");for(let i=0;i<e;++i){const o=k(t),l=k(t),c={x1:o.x,y1:o.y,x2:l.x,y2:l.y,strokeWidth:n};let d=U("line",c);t.doc.appendChild(d),t.elem=d,V(t,r,!1)}},Ce=t=>{let e=255;for(;e!=0;)switch(e=t.view.getUint8(t.cursor++),e&63){case 0:break;case 1:{const r=wt(t,e>>>6&3);xe(t,r.size,r.style)}break;case 2:{const r=wt(t,e>>>6&3);he(t,r.size,r.style)}break;case 3:{const r=wt(t,e>>>6&3);pe(t,r.size,r.style)}break;case 4:{const r=ot(t,e>>>6&3);ve(t,r.size,r.style,r.line_width)}break;case 5:{const r=ot(t,e>>>6&3);Et(t,r.size,r.style,r.line_width,!0)}break;case 6:{const r=ot(t,e>>>6&3);Et(t,r.size,r.style,r.line_width,!1)}break;case 7:{const r=ot(t,e>>>6&3);we(t,r.size,r.style,r.line_width)}break;case 8:{const r=yt(t,e>>>6&3);me(t,r.size,r.fill_style,r.line_style,r.line_width)}break;case 9:{const r=yt(t,e>>>6&3);ge(t,r.size,r.fill_style,r.line_style,r.line_width)}break;case 10:{const r=yt(t,e>>>6&3);ye(t,r.size,r.fill_style,r.line_style,r.line_width)}break;default:throw new Error(`TinyVG: Invalid command in document (0x${st(e)})`)}},$e=t=>{if(t){const e=new DataView(t);if(e.byteLength>5&&e.getUint8(0)==114&&e.getUint8(1)==86&&e.getUint8(2)==1){const r=e.getUint8(3)>>>6&3,n=St(r,4,t),i=St(r,4+ce(r),t);return{width:lt(r,n),height:lt(r,i)}}}},be=(t,e)=>{if(!e)throw new Error("TinyVG: Must provide an ArrayBuffer with TVG data");const r=new DataView(e);if(r.byteLength>5&&r.getUint8(0)==114&&r.getUint8(1)==86&&r.getUint8(2)==1){const n=le(e,t);if(n.doc){const i=r.getUint8(3);n.scale=i&15,n.color_encoding=i>>>4&3,n.coord_range=i>>>6&3,n.cursor=4;const o=vt(n),l=vt(n);n.width=lt(n,o),n.height=lt(n,l);const c=B(n);if(!c||c===0)throw new Error("TinyVG: invalid format - color table contains nothing");for(let d=0;d<c;++d)n.colors.push(ue(n));for(;n.doc.firstChild;)n.doc.removeChild(n.doc.lastChild);S(n.doc,"width",o.toString(10)),S(n.doc,"height",l.toString(10)),S(n.doc,"viewBox",`0 0 ${o} ${l}`),Ce(n);return}}throw new Error("TinyVG: Not a valid TinyVG file")},K=t=>{const e=t.view.getUint8(t.dataCursor);return t.dataCursor+=1,e},M=t=>{const e=t.view.getUint16(t.dataCursor,!0);return t.dataCursor+=2,e},Lt=t=>{const e=t.view.getUint32(t.dataCursor,!0);return t.dataCursor+=4,e},_e=(t,e)=>{if(t.charTableOffset===0)throw new Error("Fon: Not initialized");if(e<t.firstCharCode||e>t.lastCharCode)throw new Error("Fon: Character not found");const r=t.charTableOffset+t.charTableLength*(e-t.firstCharCode);t.dataCursor=r+t.fontOffset},je=(t,e=0)=>{const r={data:t,view:new DataView(t),fontIndex:e,lineHeight:0,width:0,fontOffset:-1,charTableOffset:-1,charTableLength:0,firstCharCode:0,lastCharCode:0,dataCursor:0};let n=!1;if(K(r)===77&&K(r)===90&&(n=!0),n){r.dataCursor=60;const o=Lt(r);if(r.dataCursor=o,K(r)===78&&K(r)===69){r.dataCursor=o+36;const l=M(r)+o;r.dataCursor=l;const c=M(r);let d=0;for(;r.fontOffset<0;){const h=M(r);if(h===0)break;const a=M(r);r.dataCursor+=4;for(let T=0;T<a;++T){const j=M(r)<<c;if(r.dataCursor+=2,h===32776){if(d===r.fontIndex){r.fontOffset=j;break}++d}if(r.fontOffset>-1)break;r.dataCursor+=8}}if(r.fontOffset<0)throw new Error("Fon: Font index out of range")}else throw new Error("Fon: Not a 16-bit Windows 3.1 Font. Might be a 32-bit font, which is not supported")}r.dataCursor=r.fontOffset;const i=M(r);if(r.dataCursor=r.fontOffset+66,M(r)&1)throw new Error("Fon: Vector fonts are not supported");return r.dataCursor=r.fontOffset+88,r.lineHeight=M(r),i==512?(r.charTableOffset=118,r.charTableLength=4):(r.charTableOffset=148,r.charTableLength=6),r.dataCursor=r.fontOffset+95,r.firstCharCode=K(r),r.lastCharCode=K(r),r},ke=t=>t.lastCharCode-t.firstCharCode+1,Ne=(t,e,r)=>{_e(t,e);const n=M(t),i=n*t.lineHeight,o=new ArrayBuffer(i*4),l=new DataView(o),c=Math.floor((n+7)/8);let d;t.charTableLength===4?d=M(t):d=Lt(t);let h=0;for(let a=0;a<t.lineHeight;++a){let T=0;for(let b=0;b<c;++b){const N=d+b*t.lineHeight+a;t.dataCursor=N+t.fontOffset,T<<=8,T|=K(t)}const j=c*8-n;T>>>=j;const f=1<<n-1;for(let b=0;b<n;++b)(T&f)!==0?l.setUint32(h,r):l.setUint32(h,0),h+=4,T<<=1}return{width:n,height:t.lineHeight,data:o}},Ae=t=>{const e=t.view.getUint8(t.dataCursor);return t.dataCursor+=1,e},R=t=>{const e=t.view.getUint32(t.dataCursor,!1);return t.dataCursor+=4,e},dt=t=>{const e=t.view.getInt32(t.dataCursor,!1);return t.dataCursor+=4,e},Ue=t=>{const e={data:t,view:new DataView(t),glyphCount:0,lineAdvance:0,lineHeight:0,ascent:0,descent:0,spaceWidth:0,dataCursor:0};e.glyphCount=R(e),e.dataCursor+=4,e.lineAdvance=R(e),e.dataCursor+=4,e.ascent=dt(e),e.descent=dt(e),e.spaceWidth=(e.ascent+e.descent)*Math.floor(2/7),e.dataCursor=24;let r=0;for(;r++<e.glyphCount;){const n=R(e);if(n>32&&n<160&&n!=127||n>255){const i=R(e);e.dataCursor+=12,i>e.lineHeight&&(e.lineHeight=i),e.dataCursor+=8}else e.dataCursor+=24}return e},Se=(t,e)=>{let r=0;for(t.dataCursor=24;r<t.glyphCount;){if(R(t)===e)return t.dataCursor-=4,r;t.dataCursor+=24,++r}return-1},Te=t=>t.glyphCount,Ee=(t,e,r)=>{if(e>32&&e<160&&e!=127||e>255){if(Se(t,e)<0){const x=t.spaceWidth,m=t.spaceWidth,W=x*t.lineHeight,O=new ArrayBuffer(W*4);return{width:x,height:t.lineHeight,advWidth:m,offset:{x:0,y:0},data:O}}t.dataCursor+=4;const n=R(t),i=R(t),o=R(t),l=t.lineAdvance-dt(t),c=dt(t),d=i*n,h=new ArrayBuffer(d*4),a=new DataView(h);let T=24+t.glyphCount*28,j=0;t.dataCursor=24;let f=0,b,N;for(;j<t.glyphCount;){const x=R(t),m=24+j*28;if(t.dataCursor=m+4,N=R(t),b=R(t),x===e){f=T;break}else f+=b*N;T+=b*N,t.dataCursor+=16,++j}if(j>=t.glyphCount){const x=t.spaceWidth,m=t.spaceWidth,W=x*t.lineHeight,O=new ArrayBuffer(W*4);return{width:x,height:t.lineHeight,advWidth:m,offset:{x:0,y:0},data:O}}t.dataCursor=f;const H=(r>>>24&255)/255;j=0;for(let x=0;x<n;++x)for(let m=0;m<i;++m){const W=Ae(t);let O;W===0?O=0:O=r&16777215|Math.floor(W*H)<<24,a.setUint32(j,O),j+=4}return{width:i,height:n,xOffset:c,advWidth:o,offset:{x:c,y:l},data:h}}else{const n=t.spaceWidth,i=t.spaceWidth,o=n*t.lineHeight,l=new ArrayBuffer(o*4);return{width:n,height:t.lineHeight,advWidth:i,offset:{x:0,y:0},data:l}}},Oe=()=>!!(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches),Wt=t=>t.type.endsWith("/json")||t.type.endsWith("/xml")||t.type.endsWith("+xml")||t.type.startsWith("text/"),Ot=t=>se(t.name),xt=t=>{if(!t||!t.length||t.length===0)return!1;const e=/^[A-Za-z_][A-Za-z0-9_]*$/,r=t.match(e);return r&&r.length>0},v=(t,e)=>t&&t.name&&t.name.toLowerCase().endsWith(e.toLowerCase()),tt=t=>{const e=t.name.toLowerCase(),r=t.type;if(r=="image/jpg"||r=="image/png"||r=="image/svg+xml"||e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".svg")||e.endsWith(".tvg"))return!0},It=t=>v(t,".vlw")||v(t,".fon")||J(t),Ft=t=>t&&t.name&&v(t,".vlw")||v(t,".fon"),J=t=>{const e=t.name.toLowerCase();return e.endsWith(".ttf")||e.endsWith(".otf")},Gt=(t,e)=>{let r=1;switch(e){case"scale_1_2":r=.5;break;case"scale_1_4":r=.25;break;case"scale_1_8":r=.125;break;default:return t}return{width:Math.ceil(t.width*r),height:Math.ceil(t.height*r)}},Ie=function*(t){for(const e of t){let r=e.codePointAt(0);if(r>=55296&&r<=56319){const n=e.codePointAt(1);if(!(n>=56320&&n<=57343))throw new Error("Unicode stream error. Unterminated high surrogate");const i=r&1023,o=n&1023;r=i<<10|o+65536}yield r}},Vt=(t,e)=>!(!t||isNaN(t)||t===0||!e||e!="px"&&e!="em"),Fe=(t,e,r)=>v(t,".fon")||t.type==="image/jpeg"||t.type==="image/png"||v(t,".vlw")?!0:!!(J(t)&&Vt(e,r)),mt=(t,e,r,n,i,o,l,c,d,h)=>{let a="";(n===void 0||n==="")&&(n="scale_1_1");const T=e.type,j=d!=null&&d.length>0&&d!="C",f=t.toUpperCase()+(j?"_HPP":"_H"),b=t.toUpperCase()+"_IMPLEMENTATION";a+=`// Automatically generated by https://honeythecodewitch.com/gfx/header\r
`,a+=`// #define ${b} in exactly one\r
`;let N=".c/.cpp";j&&(N=".cpp"),a+=`// translation unit (${N} file) before including this header\r
`,a+=`#ifndef ${f}\r
`,a+=`#define ${f}\r
`;const H=Wt(e);(j||!H)&&(a+=`#include <stdint.h>\r
`);let x;r&&r.width&&r.height&&r.width>0&&r.height>0&&(x=r);let m=!1,W=!1,O=!1,rt=!1,P=!1,Z=!1,z=!1,X=!1,$=j?"constant data stream":"constant source data";if(v(e,".fon")?(W=!0,m=W,$="Windows 3.1 raster font"):T==="image/jpeg"?(P=!0,m=!0,$="JPEG image"):T==="image/svg+xml"?(z=!0,$="Scalable Vector Graphic"):v(e,".tvg")?(X=!0,$="TInyVG binary vector graphic"):T==="image/png"?(Z=!0,m=!0,$="PNG image"):v(e,".vlw")?(rt=!0,m=!0,$="Processing antialiased raster font"):J(e)?(v(".otf")?$="OpenType vector font":$="TrueType vector font",o&&!isNaN(o)&&o!=0&&l&&l!==""&&l!=="none"&&(O=!0,m=!0)):J(e)&&(v(".otf")?$="OpenType vector font":$="TrueType vector font"),j){if(W)a+=`#include "gfx_win_font.hpp"\r
\r
`,a+=`/// @brief A ${$}\r
`,a+=`extern gfx::win_font ${t};\r
`;else if(rt)a+=`#include "gfx_vlw_font.hpp"\r
\r
`,a+=`/// @brief A ${$}\r
`,a+=`extern gfx::vlw_font ${t};\r
`;else if(P){if(a+=`#include "gfx_jpg_image.hpp"\r
\r
`,x){const Q=Gt(x,n);a+=`#define ${t.toUpperCase()}_DIMENSIONS {${Q.width}, ${Q.height}}\r
\r
`}a+=`/// @brief A ${$}\r
`,a+=`extern gfx::jpg_image ${t};\r
`}else Z?(a+=`#include "gfx_png_image.hpp"\r
\r
`,x&&(a+=`#define ${t.toUpperCase()}_DIMENSIONS {${x.width}, ${x.height}}\r
\r
`),a+=`/// @brief A ${$}\r
`,a+=`extern gfx::png_image ${t};\r
`):O?(a+=`#include "gfx_ttf_font.hpp"\r
\r
`,a+=`/// @brief A ${$}\r
`,a+=`extern gfx::ttf_font ${t};\r
`):(a+=`#include "gfx_core.hpp"\r
\r
`,(z||X)&&x&&(a+=`const constexpr gfx::sizef ${t}_dimensions(${x.width}, ${x.height});\r
\r
`),a+=`/// @brief A ${$}\r
`,a+=`extern gfx::const_buffer_stream ${t};\r
`);c&&m&&(a+=`/// @brief A ${$} constant source stream\r
`,a+=`extern gfx::const_buffer_stream ${t}_stream;\r
`)}else if(H){if(h){const Q=new DataView(h);a+=`#define ${t.toUpperCase()}_LENGTH (${Q.byteLength})\r
`}else a+=`#define ${t.toUpperCase()}_LENGTH (${e.size})\r
`;(z||X||Z||P)&&x&&(a+=`#define ${t.toUpperCase()}_DIMENSIONS {${x.width}, ${x.height}}\r
\r
`),a+=`#ifdef __cplusplus\r
extern "C"\r
#else\r
extern\r
#endif\r
`,a+=`/// @brief A ${$}\r
`,a+=`const char* ${t};\r
`}else(z||X||Z||P)&&x&&(a+=`#define ${t.toUpperCase()}_DIMENSIONS {${x.width}, ${x.height}}\r
\r
`),a+=`#ifdef __cplusplus\r
extern "C"\r
#else\r
extern\r
#endif\r
`,a+=`/// @brief A ${$}\r
`,a+=`const uint8_t ${t}[];\r
`;if(a+=`#endif // ${f}\r
\r
`,a+=`#ifdef ${b}\r
`,j){if(H?a+=At(t+"_data",h,!0)+`\r
\r
`:a+=Ut(t+"_data",h,!0)+`\r
\r
`,m&&!c&&(a+=`static gfx::const_buffer_stream ${t}_stream\r
    (${t}_data, sizeof(${t}_data));\r
`),W)i&&i!=0?a+=`gfx::win_font ${t}\r
    (${t}_stream, ${i});\r
`:a+=`gfx::win_font ${t}\r
    (${t}_stream);\r
`;else if(rt)a+=`gfx::vlw_font ${t}\r
    (${t}_stream);\r
`;else if(P)n&&n!="scale_1_1"?a+=`gfx::jpg_image ${t}\r
    (${t}_stream, jpg_scale::${n});\r
`:a+=`gfx::jpg_image ${t}\r
    (${t}_stream);\r
`;else if(Z)a+=`gfx::png_image ${t}\r
    (${t}_stream);\r
`;else if(O)a+=`gfx::ttf_font ${t}\r
    (${t}_stream, ${o}, gfx::font_size_units::${l})\r
`;else if(H)if(h){const Q=new DataView(h);a+=`gfx::const_buffer_stream ${t}\r
    ((const uint8_t*)${t}_data, ${Q.byteLength});\r
`}else a+=`gfx::const_buffer_stream ${t}\r
    ((const uint8_t*)${t}_data, ${e.size});\r
`;else a+=`gfx::const_buffer_stream ${t}\r
    (${t}_data, sizeof(${t}_data));\r
`;m&&c&&(a+=`gfx::const_buffer_stream ${t}_stream\r
    (${t}_data, sizeof(${t}_data));\r
`)}else H?a+=At(t,h,!1)+`\r
`:a+=Ut(t,h,!1)+`\r
`;return a+=`#endif // ${b}\r
`,a},Le=(t,e)=>e==="C"||e===void 0||e===""?`${t}.h`:`${t}.hpp`,We=t=>t==="C"||t===void 0||t===""?"c":"cpp",ze=()=>{pt.registerLanguage("c",ie),pt.registerLanguage("cpp",oe);let t,e,r,n,i,o,l,c,d,h,a;const[T,j]=I.useState(Oe()?kt:Nt);I.useEffect(()=>{const u=p=>{j(p.matches?kt:Nt)},g=window.matchMedia("(prefers-color-scheme: dark)");return g.addEventListener("change",u),()=>g.removeEventListener("change",u)},[]);const f=I.useRef(""),b=I.useRef(void 0),N=I.useRef(""),[H,x]=I.useState(!1),[m,W]=I.useState(""),[O,rt]=I.useState(0),[P,Z]=I.useState(0),[z,X]=I.useState(0),[$,Q]=I.useState("none"),[it,Ct]=I.useState("scale_1_1"),[Y,ut]=I.useState(""),[F,zt]=I.useState("C"),[ft,Rt]=I.useState(!1),[$t,bt]=I.useState(0),_t=u=>(b.current=void 0,f.current=u,W(Ot(u)),t=void 0,u),Ht=u=>{if(u.target.files.length===0)return;const g=_t(u.target.files[0]);if(tt(g)||It(g)){if(b.current){D();return}let p=new FileReader;p.onload=async function(w){b.current=w.target.result,D()},p.readAsArrayBuffer(u.target.files[0])}},Mt=u=>{m!=u.target.value&&(o=u.target.value,W(o),t=void 0)},Dt=u=>{let g;u.target.value.length>0?(g=Number.parseInt(u.target.value),isNaN(g)&&(g=0)):g=0,c=g,x(!1),rt(c),t=void 0,D()},Bt=u=>{let g=u.target.value;(g===void 0||g==="")&&(g="scale_1_1"),h=g,Ct(g),t=void 0,D()},Pt=u=>{let g=Number.parseFloat(u.target.value);l=g,X(g),t=void 0,D()},Zt=u=>{d=u.target.value,d||(d="none"),Q(d),t=void 0,D()},Qt=u=>{e=u.target.value,zt(e),h="scale_1_1",Ct(h),t=void 0,D()},qt=u=>{r=u.target.checked,Rt(r),t=void 0},ht=async(u,g=!1)=>new Promise((p,w)=>{if(g){const C=new TextDecoder("utf-8").decode(u),_=new DOMParser().parseFromString(C,"image/svg+xml").documentElement;document.body.appendChild(_);let y,E=_.getAttributeNS(null,"width"),A=_.getAttributeNS(null,"height");if(E&&A&&E.length>0&&A.length>0)y={width:Math.ceil(parseFloat(E)),height:Math.ceil(parseFloat(A))};else{const L=_.getBBox();y={width:Math.ceil(L.width+L.x),height:Math.ceil(L.height+L.y)}}document.body.removeChild(_),y&&y.width>0?p(y):w()}else{let C=$e(u);if(C)p(C);else{const _=URL.createObjectURL(new Blob([u])),y=new Image;y.onload=()=>{C={width:y.naturalWidth,height:y.naturalHeight},p(C)},y.src=_}}}),Jt=()=>{if(f.current){if(!F||F===""||F==="C")return Wt(f.current)?"const char*":"const uint8_t[]";const u=f.current.type;f.current.name;const g=z,p=$;return u===void 0||u===""&&v(f.current,".fon")?"gfx::win_font":u==="image/jpeg"?"gfx::jpg_image":u==="image/png"?"gfx::png_image":v(f.current,".vlw")?"gfx::vlw_font":J(f.current)&&g&&!isNaN(g)&&g!=0&&p?"gfx::ttf_font":"gfx::const_buffer_stream"}},Kt=()=>{if(!t&&f.current){let u=new FileReader;u.onload=async function(g){console.log("generating content to clipboard"),t=mt(m,f.current,Y,it,O,z,$,ft,F,g.target.result),await navigator.clipboard.writeText(t)},u.readAsArrayBuffer(f.current)}else t&&(console.log("writing content to clipboard"),navigator.clipboard.writeText(t))},jt=()=>{const u=new Blob([t],{type:"text/plain"});N.current!=null&&N.current.length>0&&(URL.revokeObjectURL(N.current),N.current=""),N.current=URL.createObjectURL(u);const g=document.createElement("a");g.download=Le(m,F),g.href=N.current,g.click(),setTimeout(()=>{N.current&&N.current.length>0&&(URL.revokeObjectURL(N.current),N.current="")},500)},Xt=()=>{if(!t&&f.current){let u=new FileReader;u.onload=function(g){console.log("generating content to file"),t=mt(m,f.current,Y,it,O,z,$,ft,F,g.target.result),jt()},u.readAsArrayBuffer(f.current)}else t&&(console.log("writing content to file"),jt())},Yt=()=>{setTimeout(function(){try{URL.revokeObjectURL(document.getElementById("picture").src)}catch{console.log("couldn't revoke url")}},1e3)},te=(u,g,p,w,C,_)=>{let y=0,E=0;for(let A=0;A<p.length;++A)if(p.charCodeAt(A)===13)y=0;else if(p.charCodeAt(A)===10)E+=g.lineHeight,y=0;else{const L=p.charCodeAt(A),q=Ne(g,L,_);if(q&&q.width){const gt=new Uint8ClampedArray(q.data),ne=new ImageData(gt,q.width,q.height);u.putImageData(ne,y+w,E+C),y+=q.width}else y+=g.width}},ee=(u,g,p,w,C,_)=>{let y=0,E=0;for(const A of Ie(p))if(A===13)y=0;else if(A===10)E+=g.lineHeight,y=0;else{const L=Ee(g,A,_);if(L&&L.width){const q=new Uint8ClampedArray(L.data),gt=new ImageData(q,L.width,L.height);u.putImageData(gt,y+w+L.offset.x,E+C+L.offset.y),y+=L.advWidth}else y+=g.spaceWidth}},D=()=>{if(!f.current||!b.current){console.log("No gen info");return}let u=b.current;const g=f.current;if(l||(l=z),d||(d=$),h||(h=it),a||(a=$t),c||(c=O),e||(F?e=F:e="C"),tt(g))if(v(f.current,".tvg")){be("tinyvg",u);const p=document.getElementById("tinyvg");ht(u,!1).then(w=>{n=w,ut(n);let C=n.width,_=n.height;p.style=`width: ${C}px; height: ${_}px`})}else if(v(f.current,".svg")){const p=document.getElementById("svgContainer");if(!p)console.log("Could not find svg container");else{const w=new TextDecoder().decode(u);p.innerHTML=w,ht(u,!0).then(C=>{n=C,ut(n);let _=n.width,y=n.height;p.style=`width: ${_}px; height: ${y}px`,p.lastElementChild.width=_,p.lastElementChild.height=y})}}else{const p=document.getElementById("picture");if(!p)console.log("Could not find picture");else{const w=new Blob([u]),C=URL.createObjectURL(w);p.src=C,ht(u,v(f.current,".svg")).then(_=>{n=_,ut(n);let y=n.width,E=n.height;if(v(f.current,".jpg")&&h&&e&&e.startsWith("G")){const A=Gt({width:y,height:E},h);y=A.width,E=A.height}p.width=y,p.height=E})}}else if(v(f.current,".fon")){let p;const w=document.getElementById("rasterFont");if(!w){console.log("Couldn't find font canvas");return}try{p=je(u,c),x(!1),a=ke(p),bt(a)}catch{console.log("Couldn't load font"),w.getContext("2d").clearRect(0,0,w.width,w.height),x(!0);return}i=p.lineHeight,Z(i),w.width=w.offsetWidth,w.height=w.offsetHeight;const C=w.getContext("2d");C.clearRect(0,0,w.width,w.height),te(C,p,`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`,0,0,4279234815)}else if(v(f.current,".vlw")){const p=Ue(u);i=p.lineHeight,Z(i),a=Te(p),bt(a);const w=document.getElementById("rasterFont");if(!w)console.log("Couldn't find font canvas");else{w.width=w.offsetWidth,w.height=w.offsetHeight;const C=w.getContext("2d");C.clearRect(0,0,w.width,w.height),ee(C,p,`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`,0,0,4279234815)}}else if(J(f.current)){const p=document.getElementById("vectorFont");if(!p)console.log("Couldn't find font container");else{const w=new Blob([u]);o||(o=m),o||(o=Ot(f.current));const C=URL.createObjectURL(w),_=new FontFace(o,`url(${C})`);_.load().then(()=>{document.fonts.add(_),URL.revokeObjectURL(C);let y=l,E=d;(!e.startsWith("G")||!Vt(y,E))&&(y=2,E="em"),p.innerHTML=`<pre style="font: ${y}${E} ${o}; color: #FF0FF0;">`+`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`.replace(/[\u00A0-\u9999<>\&]/g,A=>"&#"+A.charCodeAt(0)+";")+"</pre>"})}}},re=u=>{u.preventDefault();const g=document.getElementById("file");g.files=u.dataTransfer.files;const p=_t(u.dataTransfer.files[0]);if(tt(p)||It(p)){if(b.current){D();return}let w=new FileReader;w.onload=async function(C){b.current=C.target.result,D()},w.readAsArrayBuffer(u.dataTransfer.files[0])}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{id:"drop-target",onDrop:re,className:"border-drag",onDragOver:u=>u.preventDefault(),children:[!f.current&&s.jsx("p",{children:"Select or drag a file here"}),s.jsx("div",{className:"input-group",children:s.jsx("table",{border:"0",children:s.jsxs("tbody",{children:[s.jsx("tr",{children:s.jsx("td",{colSpan:2,children:s.jsx("input",{id:"file",type:"file",onChange:Ht})})}),f.current&&s.jsxs(s.Fragment,{children:[s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("label",{children:"Output:"})}),s.jsx("td",{children:s.jsxs("select",{id:"output",defaultValue:F,onChange:Qt,children:[s.jsx("option",{value:"C",children:"Raw C/++"}),s.jsx("option",{value:"GFX2",children:"GFX 2.x"})]})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("label",{children:"Identifier: "})}),s.jsx("td",{children:s.jsx("input",{type:"text",id:"identifier",value:m,onChange:Mt})})]}),v(f.current,".fon")&&F.startsWith("G")&&s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("label",{children:"Set Index: "})}),s.jsx("td",{children:s.jsx("input",{type:"text",onChange:Dt})})]}),J(f.current)&&F.startsWith("G")&&s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("label",{children:"Size: "})}),s.jsxs("td",{children:[s.jsx("input",{type:"text",onChange:Pt}),s.jsxs("select",{onChange:Zt,children:[s.jsx("option",{value:"none",children:"none"}),s.jsx("option",{value:"em",children:"em"}),s.jsx("option",{value:"px",children:"px"})]})]})]}),Fe(f.current,z,$)&&F.startsWith("G")&&s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("label",{children:"Stream: "})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",onChange:qt})})]}),f.current.type=="image/jpeg"&&F.startsWith("G")&&s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("label",{children:"Scale: "})}),s.jsx("td",{children:s.jsxs("select",{onChange:Bt,children:[s.jsx("option",{value:"scale_1_1",children:"1:1"}),s.jsx("option",{value:"scale_1_2",children:"1:2"}),s.jsx("option",{value:"scale_1_4",children:"1:4"}),s.jsx("option",{value:"scale_1_8",children:"1:8"})]})})]})]})]})})}),f.current&&s.jsxs("section",{children:["File details:",s.jsxs("ul",{children:[f.current.type&&s.jsxs("li",{children:["MIME: ",s.jsx("span",{className:"fileType",children:f.current.type})]}),tt(f.current)&&Y&&s.jsxs("li",{children:["Dimensions: ",s.jsxs("span",{className:"fileDim",children:[Y.width,"x",Y.height]})]}),Ft(f.current)&&P>0&&s.jsxs("li",{children:["Line Height: ",s.jsx("span",{className:"fontHeight",children:P})]}),Ft(f.current)&&s.jsxs("li",{children:["Glyph Count: ",s.jsx("span",{className:"fontGlyphCount",children:$t})]}),s.jsxs("li",{children:["Size: ",s.jsxs("span",{className:"fileSize",children:[f.current.size," bytes"]})]}),s.jsxs("li",{children:["Type: ",s.jsx("span",{className:"genType",children:Jt()})]})]})]}),f.current&&s.jsxs(s.Fragment,{children:[xt(m)&&(!v(f.current,".fon")||H===!1)&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:Xt,className:"submit",children:"Download header file"}),s.jsx("br",{}),s.jsx("button",{onClick:Kt,className:"submit",children:"Copy to clipboard"})]}),!xt(m)&&s.jsx(s.Fragment,{children:s.jsx("span",{style:{color:"red"},children:"Error: Invalid identifier"})}),v(f.current,".fon")&&H&&s.jsx(s.Fragment,{children:s.jsx("span",{style:{color:"red"},children:"Error: Invalid font index"})})]})]}),s.jsx("br",{}),f.current&&s.jsx(s.Fragment,{children:s.jsx("h4",{children:"Preview"})})&&s.jsxs(s.Fragment,{children:[xt(m)&&s.jsx(pt,{style:T,language:We(F),children:mt(m,f.current,Y,it,O,z,$,ft,F,void 0)}),v(f.current,".tvg")&&s.jsx("svg",{id:"tinyvg",xmlns:"http://www.w3.org/2000/svg"}),!v(f.current,".tvg")&&!v(f.current,".svg")&&tt(f.current)&&s.jsx("img",{id:"picture",onLoad:Yt()}),v(f.current,".svg")&&tt(f.current)&&s.jsx("div",{id:"svgContainer"}),(v(f.current,".fon")||v(f.current,".vlw"))&&s.jsx("canvas",{id:"rasterFont",width:800,height:300,style:{width:"%100",height:"100%"}}),J(f.current)&&s.jsx("span",{id:"vectorFont",style:{width:"800px",height:"300px"}})]})]})};export{ze as default};
