import{r as G,j as i}from"./main-DtxJ0GBT.js";import{S as we,c as st,a as ot,b as ke,d as Ae,g as Se,e as Ue,t as it}from"./CGen-CJBk85bF.js";const at=(e,t)=>({data:e,view:new DataView(e),cursor:0,scale:0,color_encoding:0,coord_range:0,width:0,height:0,colors_size:0,colors:[],doc:document.getElementById(t),elem:void 0,gradIndex:0}),lt=(e,t)=>{const r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)},ct=e=>{let t=e;switch(e.coord_range&&(t=e.range),t){case 0:return 2;case 1:return 1;case 2:return 4}},ce=(e,t)=>{let r=e;if(e.coord_range&&(r=e.range),t==0){switch(r){case 0:return 65535;case 1:return 255;case 2:return 4294967295}return}return t},Ne=(e,t,r)=>{const n=new DataView(r);switch(e){case 0:return n.getUint16(t,!0);case 1:return n.getUint8(t);case 2:return n.getUint32(t,!0)}},be=e=>{let t;switch(e.coord_range){case 0:t=e.view.getUint16(e.cursor,!0),e.cursor+=2;break;case 1:t=e.view.getUint8(e.cursor),e.cursor+=1;break;case 2:t=e.view.getUint32(e.cursor,!0),e.cursor+=4;break}return t},B=e=>{let t=0,r=0,n;for(;;){n=e.view.getUint8(e.cursor++);const s=(n&127)<<7*t;if(r|=s,(n&128)===0)break;++t}return r},dt=(e,t)=>{const r=1<<e.scale;return t/r},W=e=>{const t=be(e);return dt(e,t)},x=e=>{const t=W(e),r=W(e);return{x:t,y:r}},ut=e=>{switch(e.color_encoding){case 2:{const t=[];return t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,{r:t[0],g:t[1],b:t[2],a:t[3]}}case 1:{const t=e.view.getUint16(e.cursor,!0);return e.cursor+=2,{r:(t&31)/15,g:(t>>>5&63)/31,b:(t>>>11&31)/15,a:1}}case 0:{const t=[];return t.push(e.view.getUint8(e.cursor++)),t.push(e.view.getUint8(e.cursor++)),t.push(e.view.getUint8(e.cursor++)),t.push(e.view.getUint8(e.cursor++)),{r:t[0]/255,g:t[1]/255,b:t[2]/255,a:t[3]/255}}case 3:throw new Error("TinyVG: Custom color table not supported");default:throw new Error("TinyVG: Invalid color format")}},Te=e=>{const t=x(e),r=x(e),n=B(e),s=B(e);return{point0:t,point1:r,color0:n,color1:s}},de=(e,t)=>{switch(t){case 0:return{kind:t,flat:B(e)};case 1:return{kind:t,linear:Te(e)};case 2:return{kind:t,radial:Te(e)};default:throw new Error("TinyVG: Invalid format parsing style")}},ye=(e,t)=>{const n=B(e)+1,s=de(e,t);return{size:n,style:s}},ae=(e,t)=>{const n=B(e)+1,s=de(e,t),o=W(e);return{size:n,style:s,line_width:o}},me=(e,t)=>{let r=e.view.getUint8(e.cursor++);const n=(r&63)+1,s=de(e,t),o=de(e,r>>>6&3),l=W(e);return{size:n,fill_style:s,line_style:o,line_width:l}},ne=(e,t)=>{let r,n,s,o,l="";s=x(e),l+=`M${s.x} ${s.y}`,r=s,n=s;for(let c=0;c<t;++c)switch(o=e.view.getUint8(e.cursor++),(o>>>4&1)!==0&&W(e),o&7){case 0:s=x(e),l+=` L${s.x} ${s.y}`,n=s;break;case 1:s.x=W(e),s.y=n.y,l+=` H${s.x}`,n=s;break;case 2:s.x=n.x,s.y=W(e),l+=` V${s.y}`,n=s;break;case 3:{const d=x(e),f=x(e),a=x(e);l+=` C${d.x} ${d.y} ${f.x} ${f.y} ${a.x} ${a.y}`,n=a}break;case 4:{o=e.view.getUint8(e.cursor++);const d=W(e);s=x(e),l+=` A${d} ${d} 0 ${o&1} ${1-(o>>>1&1)} ${s.x} ${s.y}`,n=s}break;case 5:{o=e.view.getUint8(e.cursor++);const d=W(e),f=W(e),a=W(e);s=x(e),l+=` A${d} ${f} ${a} ${o&1} ${1-(o>>>1&1)} ${s.x} ${s.y}`,n=s}break;case 6:l+=" Z",n=r;break;case 7:{const d=x(e),f=x(e);l+=` Q${d.x} ${d.y} ${f.x} ${f.y}`,n=f}break;default:throw new Error("TinyVG: Unrecognized command parsing path")}return l},ue=e=>{const t=x(e),r=W(e),n=W(e);return{x:t.x,y:t.y,width:r,height:n}},le=e=>{let t=e.toString(16);return t.length===1?"0"+t:t},oe=e=>({color:`#${le(e.r*255)}${le(e.g*255)}${le(e.b*255)}`,opacity:e.a}),A=(e,t)=>{if(e=document.createElementNS("http://www.w3.org/2000/svg",e),t)for(let r in t)e.setAttributeNS(null,r.replace(/[A-Z]/g,function(n,s,o,l){return"-"+n.toLowerCase()}),t[r]);return e},S=(e,t,r)=>{e.setAttributeNS(null,t,r)},ht=(e,t)=>{let r=e.doc.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs"),n;if(r.length==0?(n=A("defs"),e.doc.prepend(n)):n=r[0],t.kind===1){const s=A("linearGradient",{id:`TvgGradient${e.gradIndex+1}`,x1:t.linear.point0.x,y1:t.linear.point0.y,x2:t.linear.point1.x,y2:t.linear.point1.y});s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"spreadMethod","pad");let o=oe(e.colors[t.linear.color0]);const l=A("stop",{offset:"0%",stopColor:o.color});s.appendChild(l),o=oe(e.colors[t.linear.color1]);const c=A("stop",{offset:"100%",stopColor:o.color});return s.appendChild(c),n.appendChild(s),++e.gradIndex,s.getAttributeNS(null,"id")}else if(t.kind===2){const s=lt(t.radial.point0,t.radial.point1),o=A("radialGradient",{id:`TvgGradient${e.gradIndex+1}`,cx:t.radial.point0.x,cy:t.radial.point0.y,fx:t.radial.point0.x,fy:t.radial.point0.y,r:s});o.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),o.setAttributeNS(null,"spreadMethod","pad");let l=oe(e.colors[t.radial.color0]);const c=A("stop",{offset:"0%",stopColor:l.color,stopOpacity:l.opacity});o.appendChild(c),l=oe(e.colors[t.radial.color1]);const d=A("stop",{offset:"100%",stopColor:l.color,stopOpacity:l.opacity});return o.appendChild(d),n.appendChild(o),++e.gradIndex,o.getAttributeNS(null,"id")}else throw t.kind===0?new Error("TinyVG: attempt to pass flat style to create gradient"):new Error("TinyVG: attempt to pass an invalid style to create gradient")},I=(e,t,r)=>{if(t.kind===0){const n=oe(e.colors[t.flat]);r?(S(e.elem,"fill",n.color),S(e.elem,"fill-opacity",n.opacity)):(S(e.elem,"stroke",n.color),S(e.elem,"stroke-opacity",n.opacity))}else if(t.kind===1||t.kind===2){const n=ht(e,t);r?S(e.elem,"fill",`url(#${n})`):S(e.elem,"stroke",`url(#${n})`)}else throw new Error("TinyVG: attempt to apply invalid style")},ft=(e,t,r)=>{let n=t;if(n===0)throw new Error("TinyVG: Invalid zero length filled rectangles entry");let s=ue(e),o=A("rect",s);e.doc.appendChild(o),e.elem=o,S(e.elem,"fill-rule","evenodd"),I(e,r,!0);const l={};for(l.fillRule="evenodd",r.kind!==0?l.fill=o.getAttributeNS(null,"fill"):(l.fill=o.getAttributeNS(null,"fill"),l.fillOpacity=o.getAttributeNS(null,"fill-opacity")),--n;n--;){s=ue(e);const c={...l,...s};o=A("rect",c),e.doc.appendChild(o),e.elem=o}},gt=(e,t,r,n,s)=>{let o=t;if(o===0)throw new Error("TinyVG: Invalid zero length line filled rectangles entry");s===0&&(s=.001);let l=ue(e),c=A("rect",l);e.doc.appendChild(c),e.elem=c,S(e.elem,"fill-rule","evenodd"),S(e.elem,"stroke-width",s),I(e,r,!0),I(e,n,!1);const d={};for(d.fillRule="evenodd",r.kind!==0?d.fill=c.getAttributeNS(null,"fill"):(d.fill=c.getAttributeNS(null,"fill"),d.fillOpacity=c.getAttributeNS(null,"fill-opacity")),n.kind!==0?d.stroke=c.getAttributeNS(null,"stroke"):(d.stroke=c.getAttributeNS(null,"stroke"),d.strokeOpacity=c.getAttributeNS(null,"stroke-opacity")),d.strokeWidth=s,--o;o--;){l=ue(e);const f={...d,...l};c=A("rect",f),e.doc.appendChild(c),e.elem=c}},pt=(e,t,r)=>{if(t===0)throw new Error("TinyVG: Invalid zero filled paths entry");const n={};n.fillRule="evenodd",n.strokeOpacity=0,n.strokeWidth=0;const s=[];for(let c=0;c<t;++c)s.push(B(e)+1);let o=A("path",n);e.doc.appendChild(o),e.elem=o,I(e,r,!0),r.kind!==0?n.fill=o.getAttributeNS(null,"fill"):(n.fill=o.getAttributeNS(null,"fill"),n.fillOpacity=o.getAttributeNS(null,"fill-opacity"));let l=ne(e,s[0]);for(let c=1;c<t;++c)l+=` ${ne(e,s[c])}`;S(o,"d",l)},wt=(e,t,r,n)=>{if(t===0)throw new Error("TinyVG: Invalid zero line paths entry");n===0&&(n=.001);const s={},o=[];for(let d=0;d<t;++d)o.push(B(e)+1);let l=A("path",s);e.doc.appendChild(l),e.elem=l,S(e.elem,"fill-opacity",0),S(e.elem,"stroke-width",n),I(e,r,!1),r.kind!==0?s.stroke=l.getAttributeNS(null,"stroke"):(s.stroke=l.getAttributeNS(null,"stroke"),s.strokeOpacity=l.getAttributeNS(null,"stroke-opacity")),s.strokeWidth=n,s.fillOpacity=0;let c=ne(e,o[0]);for(let d=1;d<t;++d)c+=` ${ne(e,o[d])}`;S(l,"d",c)},yt=(e,t,r,n,s)=>{if(t===0)throw new Error("TinyVG: Invalid zero line filled paths entry");s===0&&(s=.001);const o={};o.fillRule="evenodd";const l=[];for(let f=0;f<t;++f)l.push(B(e)+1);let c=A("path",o);e.doc.appendChild(c),e.elem=c,I(e,r,!0),r.kind!==0?o.fill=c.getAttributeNS(null,"fill"):(o.fill=c.getAttributeNS(null,"fill"),o.fillOpacity=c.getAttributeNS(null,"fill-opacity")),I(e,n,!1),n.kind!==0?o.stroke=c.getAttributeNS(null,"stroke"):(o.stroke=c.getAttributeNS(null,"stroke"),o.strokeOpacity=c.getAttributeNS(null,"stroke-opacity")),o.strokeWidth=s,S(c,"stroke-width",s);let d=ne(e,l[0]);for(let f=1;f<t;++f)d+=` ${ne(e,l[f])}`;S(c,"d",d)},mt=(e,t,r)=>{if(t===0)throw new Error("TinyVG: Invalid zero polygon entry");let n=t,s="",o=x(e);for(s+=`${o.x},${o.y}`;--n;)o=x(e),s+=` ${o.x},${o.y}`;let c=A("polygon",{fillRule:"evenodd",points:s});e.doc.appendChild(c),e.elem=c,I(e,r,!0)},Ee=(e,t,r,n,s)=>{if(t===0)throw new Error("TinyVG: Invalid zero polyline entry");n===0&&(n=.001);let o=t,l="",c=x(e);for(l+=`${c.x},${c.y}`;--o;)c=x(e),l+=` ${c.x},${c.y}`;let f=A(s?"polygon":"polyline",{points:l,lineWidth:n,fillOpacity:0});e.doc.appendChild(f),e.elem=f,I(e,r,!1)},vt=(e,t,r,n,s,o)=>{if(t===0)throw new Error("TinyVG: Invalid zero line fill polyline entry");s===0&&(s=.001);let l=t,c="",d=x(e);for(c+=`${d.x},${d.y}`;--l;)d=x(e),c+=` ${d.x},${d.y}`;let a=A("polygon",{points:c,lineWidth:s,fillRule:"evenodd"});e.doc.appendChild(a),e.elem=a,I(e,r,!0),I(e,n,!1)},Ct=(e,t,r,n)=>{if(t===0)throw new Error("TinyVG: Invalid zero lines entry");for(let s=0;s<t;++s){const o=x(e),l=x(e),c={x1:o.x,y1:o.y,x2:l.x,y2:l.y,strokeWidth:n};let d=A("line",c);e.doc.appendChild(d),e.elem=d,I(e,r,!1)}},bt=e=>{let t=255;for(;t!=0;)switch(t=e.view.getUint8(e.cursor++),t&63){case 0:break;case 1:{const r=ye(e,t>>>6&3);mt(e,r.size,r.style)}break;case 2:{const r=ye(e,t>>>6&3);ft(e,r.size,r.style)}break;case 3:{const r=ye(e,t>>>6&3);pt(e,r.size,r.style)}break;case 4:{const r=ae(e,t>>>6&3);Ct(e,r.size,r.style,r.line_width)}break;case 5:{const r=ae(e,t>>>6&3);Ee(e,r.size,r.style,r.line_width,!0)}break;case 6:{const r=ae(e,t>>>6&3);Ee(e,r.size,r.style,r.line_width,!1)}break;case 7:{const r=ae(e,t>>>6&3);wt(e,r.size,r.style,r.line_width)}break;case 8:{const r=me(e,t>>>6&3);vt(e,r.size,r.fill_style,r.line_style,r.line_width)}break;case 9:{const r=me(e,t>>>6&3);gt(e,r.size,r.fill_style,r.line_style,r.line_width)}break;case 10:{const r=me(e,t>>>6&3);yt(e,r.size,r.fill_style,r.line_style,r.line_width)}break;default:throw new Error(`TinyVG: Invalid command in document (0x${le(t)})`)}},$t=e=>{if(e){const t=new DataView(e);if(t.byteLength>5&&t.getUint8(0)==114&&t.getUint8(1)==86&&t.getUint8(2)==1){const n=t.getUint8(3)>>>6&3,s=Ne(n,4,e),o=Ne(n,4+ct(n),e);return{width:ce(n,s),height:ce(n,o)}}}},_t=(e,t)=>{if(!t)throw new Error("TinyVG: Must provide an ArrayBuffer with TVG data");const r=new DataView(t);if(r.byteLength>5&&r.getUint8(0)==114&&r.getUint8(1)==86&&r.getUint8(2)==1){const n=at(t,e);if(n.doc){const s=r.getUint8(3);n.scale=s&15,n.color_encoding=s>>>4&3,n.coord_range=s>>>6&3,n.cursor=4;const o=be(n),l=be(n);n.width=ce(n,o),n.height=ce(n,l);const c=B(n);if(!c||c===0)throw new Error("TinyVG: invalid format - color table contains nothing");for(let d=0;d<c;++d)n.colors.push(ut(n));for(;n.doc.firstChild;)n.doc.removeChild(n.doc.lastChild);S(n.doc,"width",o.toString(10)),S(n.doc,"height",l.toString(10)),S(n.doc,"viewBox",`0 0 ${o} ${l}`),bt(n);return}}throw new Error("TinyVG: Not a valid TinyVG file")},K=e=>{const t=e.view.getUint8(e.dataCursor);return e.dataCursor+=1,t},D=e=>{const t=e.view.getUint16(e.dataCursor,!0);return e.dataCursor+=2,t},Oe=e=>{const t=e.view.getUint32(e.dataCursor,!0);return e.dataCursor+=4,t},jt=(e,t)=>{if(e.charTableOffset===0)throw new Error("Fon: Not initialized");if(t<e.firstCharCode||t>e.lastCharCode)throw new Error("Fon: Character not found");const r=e.charTableOffset+e.charTableLength*(t-e.firstCharCode);e.dataCursor=r+e.fontOffset},Ft=(e,t=0)=>{const r={data:e,view:new DataView(e),fontIndex:t,lineHeight:0,width:0,fontOffset:-1,charTableOffset:-1,charTableLength:0,firstCharCode:0,lastCharCode:0,dataCursor:0};let n=!1;if(K(r)===77&&K(r)===90&&(n=!0),n){r.dataCursor=60;const l=Oe(r);if(r.dataCursor=l,K(r)===78&&K(r)===69){r.dataCursor=l+36;const d=D(r)+l;r.dataCursor=d;const f=D(r);let a=0;for(;r.fontOffset<0;){const U=D(r);if(U===0)break;const j=D(r);r.dataCursor+=4;for(let u=0;u<j;++u){const _=D(r)<<f;if(r.dataCursor+=2,U===32776){if(a===r.fontIndex){r.fontOffset=_;break}++a}if(r.fontOffset>-1)break;r.dataCursor+=8}}if(r.fontOffset<0)throw new Error("Fon: Font index out of range")}else throw new Error("Fon: Not a 16-bit Windows 3.1 Font. Might be a 32-bit font, which is not supported")}r.dataCursor=r.fontOffset;const s=D(r);if(r.dataCursor=r.fontOffset+66,D(r)&1)throw new Error("Fon: Vector fonts are not supported");return r.dataCursor=r.fontOffset+88,r.lineHeight=D(r),s==512?(r.charTableOffset=118,r.charTableLength=4):(r.charTableOffset=148,r.charTableLength=6),r.dataCursor=r.fontOffset+95,r.firstCharCode=K(r),r.lastCharCode=K(r),r},xt=e=>e.lastCharCode-e.firstCharCode+1,kt=(e,t,r)=>{jt(e,t);const n=D(e),s=n*e.lineHeight,o=new ArrayBuffer(s*4),l=new DataView(o),c=Math.floor((n+7)/8);let d;e.charTableLength===4?d=D(e):d=Oe(e);let f=0;for(let a=0;a<e.lineHeight;++a){let U=0;for(let _=0;_<c;++_){const k=d+_*e.lineHeight+a;e.dataCursor=k+e.fontOffset,U<<=8,U|=K(e)}const j=c*8-n;U>>>=j;const u=1<<n-1;for(let _=0;_<n;++_)(U&u)!==0?l.setUint32(f,r):l.setUint32(f,0),f+=4,U<<=1}return{width:n,height:e.lineHeight,data:o}},At=e=>{const t=e.view.getUint8(e.dataCursor);return e.dataCursor+=1,t},z=e=>{const t=e.view.getUint32(e.dataCursor,!1);return e.dataCursor+=4,t},he=e=>{const t=e.view.getInt32(e.dataCursor,!1);return e.dataCursor+=4,t},St=e=>{const t={data:e,view:new DataView(e),glyphCount:0,lineAdvance:0,lineHeight:0,ascent:0,descent:0,spaceWidth:0,dataCursor:0};t.glyphCount=z(t),t.dataCursor+=4,t.lineAdvance=z(t),t.dataCursor+=4,t.ascent=he(t),t.descent=he(t),t.spaceWidth=(t.ascent+t.descent)*Math.floor(2/7),t.dataCursor=24;let r=0;for(;r++<t.glyphCount;){const n=z(t);if(n>32&&n<160&&n!=127||n>255){const s=z(t);t.dataCursor+=12,s>t.lineHeight&&(t.lineHeight=s),t.dataCursor+=8}else t.dataCursor+=24}return t},Ut=(e,t)=>{let r=0;for(e.dataCursor=24;r<e.glyphCount;){if(z(e)===t)return e.dataCursor-=4,r;e.dataCursor+=24,++r}return-1},Nt=e=>e.glyphCount,Tt=(e,t,r)=>{if(t>32&&t<160&&t!=127||t>255){if(Ut(e,t)<0){const y=e.spaceWidth,m=e.spaceWidth,O=y*e.lineHeight,E=new ArrayBuffer(O*4);return{width:y,height:e.lineHeight,advWidth:m,offset:{x:0,y:0},data:E}}e.dataCursor+=4;const n=z(e),s=z(e),o=z(e),l=e.lineAdvance-he(e),c=he(e),d=s*n,f=new ArrayBuffer(d*4),a=new DataView(f);let U=24+e.glyphCount*28,j=0;e.dataCursor=24;let u=0,_,k;for(;j<e.glyphCount;){const y=z(e),m=24+j*28;if(e.dataCursor=m+4,k=z(e),_=z(e),y===t){u=U;break}else u+=_*k;U+=_*k,e.dataCursor+=16,++j}if(j>=e.glyphCount){const y=e.spaceWidth,m=e.spaceWidth,O=y*e.lineHeight,E=new ArrayBuffer(O*4);return{width:y,height:e.lineHeight,advWidth:m,offset:{x:0,y:0},data:E}}e.dataCursor=u;const P=(r>>>24&255)/255;j=0;for(let y=0;y<n;++y)for(let m=0;m<s;++m){const O=At(e);let E;O===0?E=0:E=r&16777215|Math.floor(O*P)<<24,a.setUint32(j,E),j+=4}return{width:s,height:n,xOffset:c,advWidth:o,offset:{x:c,y:l},data:f}}else{const n=e.spaceWidth,s=e.spaceWidth,o=n*e.lineHeight,l=new ArrayBuffer(o*4);return{width:n,height:e.lineHeight,advWidth:s,offset:{x:0,y:0},data:l}}},Et=()=>!!(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches),We=e=>e.type.endsWith("/json")||e.type.endsWith("/xml")||e.type.endsWith("+xml")||e.type.startsWith("text/"),Le=e=>it(e.name),ve=e=>{if(!e||!e.length||e.length===0)return!1;const t=/^[A-Za-z_][A-Za-z0-9_]*$/,r=e.match(t);return r&&r.length>0},C=(e,t)=>e&&e.name&&e.name.toLowerCase().endsWith(t.toLowerCase()),re=e=>{const t=e.name.toLowerCase(),r=e.type;if(r=="image/jpg"||r=="image/png"||r=="image/svg+xml"||t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".svg")||t.endsWith(".tvg"))return!0},Ge=e=>C(e,".vlw")||C(e,".fon")||X(e),Re=e=>e&&e.name&&C(e,".vlw")||C(e,".fon"),X=e=>{const t=e.name.toLowerCase();return t.endsWith(".ttf")||t.endsWith(".otf")},Ve=(e,t)=>{let r=1;switch(t){case"scale_1_2":r=.5;break;case"scale_1_4":r=.25;break;case"scale_1_8":r=.125;break;default:return e}return{width:Math.ceil(e.width*r),height:Math.ceil(e.height*r)}},Lt=function*(e){for(const t of e){let r=t.codePointAt(0);if(r>=55296&&r<=56319){const n=t.codePointAt(1);if(!(n>=56320&&n<=57343))throw new Error("Unicode stream error. Unterminated high surrogate");const s=r&1023,o=n&1023;r=s<<10|o+65536}yield r}},Ie=(e,t)=>!(!e||isNaN(e)||e===0||!t||t!="px"&&t!="em"),Gt=(e,t,r)=>C(e,".fon")||e.type==="image/jpeg"||e.type==="image/png"||C(e,".vlw")?!0:!!(X(e)&&Ie(t,r)),Ce=(e,t,r,n,s,o,l,c,d,f)=>{let a="";(n===void 0||n==="")&&(n="scale_1_1");const U=t.type,j=d!=null&&d.length>0&&d!="C",u=e.toUpperCase()+(j?"_HPP":"_H"),_=e.toUpperCase()+"_IMPLEMENTATION";a+=`// Automatically generated by https://honeythecodewitch.com/gfx/header\r
`,a+=`// #define ${_} in exactly one\r
`;let k=".c/.cpp";j&&(k=".cpp"),a+=`// translation unit (${k} file) before including this header\r
`,a+=`#ifndef ${u}\r
`,a+=`#define ${u}\r
`;const P=We(t);(j||!P)&&(a+=`#include <stdint.h>\r
`);let y;r&&r.width&&r.height&&r.width>0&&r.height>0&&(y=r);let m=!1,O=!1,E=!1,se=!1,Z=!1,J=!1,H=!1,Y=!1,b=j?"constant data stream":"constant source data";if(C(t,".fon")?(O=!0,m=O,b="Windows 3.1 raster font"):U==="image/jpeg"?(Z=!0,m=!0,b="JPEG image"):U==="image/svg+xml"?(H=!0,b="Scalable Vector Graphic"):C(t,".tvg")?(Y=!0,b="TInyVG binary vector graphic"):U==="image/png"?(J=!0,m=!0,b="PNG image"):C(t,".vlw")?(se=!0,m=!0,b="Processing antialiased raster font"):X(t)?(C(".otf")?b="OpenType vector font":b="TrueType vector font",o&&!isNaN(o)&&o!=0&&l&&l!==""&&l!=="none"&&(E=!0,m=!0)):X(t)&&(C(".otf")?b="OpenType vector font":b="TrueType vector font"),j){if(O)a+=`#include "gfx_win_font.hpp"\r
\r
`,a+=`/// @brief A ${b}\r
`,a+=`extern gfx::win_font ${e};\r
`;else if(se)a+=`#include "gfx_vlw_font.hpp"\r
\r
`,a+=`/// @brief A ${b}\r
`,a+=`extern gfx::vlw_font ${e};\r
`;else if(Z){if(a+=`#include "gfx_jpg_image.hpp"\r
\r
`,y){const Q=Ve(y,n);a+=`#define ${e.toUpperCase()}_DIMENSIONS {${Q.width}, ${Q.height}}\r
\r
`}a+=`/// @brief A ${b}\r
`,a+=`extern gfx::jpg_image ${e};\r
`}else J?(a+=`#include "gfx_png_image.hpp"\r
\r
`,y&&(a+=`#define ${e.toUpperCase()}_DIMENSIONS {${y.width}, ${y.height}}\r
\r
`),a+=`/// @brief A ${b}\r
`,a+=`extern gfx::png_image ${e};\r
`):E?(a+=`#include "gfx_ttf_font.hpp"\r
\r
`,a+=`/// @brief A ${b}\r
`,a+=`extern gfx::ttf_font ${e};\r
`):(a+=`#include "gfx_core.hpp"\r
\r
`,(H||Y)&&y&&(a+=`const constexpr gfx::sizef ${e}_dimensions(${y.width}, ${y.height});\r
\r
`),a+=`/// @brief A ${b}\r
`,a+=`extern gfx::const_buffer_stream ${e};\r
`);c&&m&&(a+=`/// @brief A ${b} constant source stream\r
`,a+=`extern gfx::const_buffer_stream ${e}_stream;\r
`)}else if(P){if(f){const Q=new DataView(f);a+=`#define ${e.toUpperCase()}_LENGTH (${Q.byteLength})\r
`}else a+=`#define ${e.toUpperCase()}_LENGTH (${t.size})\r
`;(H||Y||J||Z)&&y&&(a+=`#define ${e.toUpperCase()}_DIMENSIONS {${y.width}, ${y.height}}\r
\r
`),a+=`#ifdef __cplusplus\r
extern "C"\r
#else\r
extern\r
#endif\r
`,a+=`/// @brief A ${b}\r
`,a+=`const char* ${e};\r
`}else(H||Y||J||Z)&&y&&(a+=`#define ${e.toUpperCase()}_DIMENSIONS {${y.width}, ${y.height}}\r
\r
`),a+=`#ifdef __cplusplus\r
extern "C"\r
#else\r
extern\r
#endif\r
`,a+=`/// @brief A ${b}\r
`,a+=`const uint8_t ${e}[];\r
`;if(a+=`#endif // ${u}\r
\r
`,a+=`#ifdef ${_}\r
`,j){if(P?a+=Se(e+"_data",f,!0)+`\r
\r
`:a+=Ue(e+"_data",f,!0)+`\r
\r
`,m&&!c&&(a+=`static gfx::const_buffer_stream ${e}_stream\r
    (${e}_data, sizeof(${e}_data));\r
`),O)s&&s!=0?a+=`gfx::win_font ${e}\r
    (${e}_stream, ${s});\r
`:a+=`gfx::win_font ${e}\r
    (${e}_stream);\r
`;else if(se)a+=`gfx::vlw_font ${e}\r
    (${e}_stream);\r
`;else if(Z)n&&n!="scale_1_1"?a+=`gfx::jpg_image ${e}\r
    (${e}_stream, jpg_scale::${n});\r
`:a+=`gfx::jpg_image ${e}\r
    (${e}_stream);\r
`;else if(J)a+=`gfx::png_image ${e}\r
    (${e}_stream);\r
`;else if(E)a+=`gfx::ttf_font ${e}\r
    (${e}_stream, ${o}, gfx::font_size_units::${l})\r
`;else if(P)if(f){const Q=new DataView(f);a+=`gfx::const_buffer_stream ${e}\r
    ((const uint8_t*)${e}_data, ${Q.byteLength});\r
`}else a+=`gfx::const_buffer_stream ${e}\r
    ((const uint8_t*)${e}_data, ${t.size});\r
`;else a+=`gfx::const_buffer_stream ${e}\r
    (${e}_data, sizeof(${e}_data));\r
`;m&&c&&(a+=`gfx::const_buffer_stream ${e}_stream\r
    (${e}_data, sizeof(${e}_data));\r
`)}else P?a+=Se(e,f,!1)+`\r
`:a+=Ue(e,f,!1)+`\r
`;return a+=`#endif // ${_}\r
`,a},Rt=(e,t)=>t==="C"||t===void 0||t===""?`${e}.h`:`${e}.hpp`,Ot=e=>e==="C"||e===void 0||e===""?"c":"cpp",It=()=>{we.registerLanguage("c",st),we.registerLanguage("cpp",ot);let e,t,r,n,s,o,l,c,d,f,a;const[U,j]=G.useState(Et()?ke:Ae);G.useEffect(()=>{const h=p=>{j(p.matches?ke:Ae)},g=window.matchMedia("(prefers-color-scheme: dark)");return g.addEventListener("change",h),()=>g.removeEventListener("change",h)},[]);const u=G.useRef(""),_=G.useRef(void 0),k=G.useRef(""),[P,y]=G.useState(!1),[m,O]=G.useState(""),[E,se]=G.useState(0),[Z,J]=G.useState(0),[H,Y]=G.useState(0),[b,Q]=G.useState("none"),[ie,$e]=G.useState("scale_1_1"),[ee,fe]=G.useState(""),[R,He]=G.useState("C"),[ge,ze]=G.useState(!1),[_e,je]=G.useState(0),Fe=h=>(_.current=void 0,u.current=h,O(Le(h)),e=void 0,h),Pe=h=>{if(h.target.files.length===0)return;const g=Fe(h.target.files[0]);if(re(g)||Ge(g)){if(_.current){M();return}let p=new FileReader;p.onload=async function(w){_.current=w.target.result,M()},p.readAsArrayBuffer(h.target.files[0])}},De=h=>{m!=h.target.value&&(o=h.target.value,O(o),e=void 0)},Me=h=>{let g;h.target.value.length>0?(g=Number.parseInt(h.target.value),isNaN(g)&&(g=0)):g=0,c=g,y(!1),se(c),e=void 0,M()},Be=h=>{let g=h.target.value;(g===void 0||g==="")&&(g="scale_1_1"),f=g,$e(g),e=void 0,M()},Ze=h=>{let g=Number.parseFloat(h.target.value);l=g,Y(g),e=void 0,M()},Je=h=>{d=h.target.value,d||(d="none"),Q(d),e=void 0,M()},Qe=h=>{t=h.target.value,He(t),f="scale_1_1",$e(f),e=void 0,M()},Xe=h=>{r=h.target.checked,ze(r),e=void 0},pe=async(h,g=!1)=>new Promise((p,w)=>{if(g){const N=new TextDecoder("utf-8").decode(h),F=new DOMParser().parseFromString(N,"image/svg+xml").documentElement;document.body.appendChild(F);let L,V=F.getAttributeNS(null,"width"),q=F.getAttributeNS(null,"height");if(V&&q&&V.length>0&&q.length>0)L={width:Math.ceil(parseFloat(V)),height:Math.ceil(parseFloat(q))};else{const te=F.getBBox();L={width:Math.ceil(te.width+te.x),height:Math.ceil(te.height+te.y)}}document.body.removeChild(F),L&&L.width>0?p(L):w()}else{let $=$t(h);if($)p($);else{const N=URL.createObjectURL(new Blob([h])),v=new Image;v.onload=()=>{$={width:v.naturalWidth,height:v.naturalHeight},p($)},v.src=N}}}),qe=()=>{if(u.current){if(!R||R===""||R==="C")return We(u.current)?"const char*":"const uint8_t[]";const h=u.current.type;u.current.name;const g=H,p=b;return h===void 0||h===""&&C(u.current,".fon")?"gfx::win_font":h==="image/jpeg"?"gfx::jpg_image":h==="image/png"?"gfx::png_image":C(u.current,".vlw")?"gfx::vlw_font":X(u.current)&&g&&!isNaN(g)&&g!=0&&p?"gfx::ttf_font":"gfx::const_buffer_stream"}},Ke=()=>{if(!e&&u.current){let h=new FileReader;h.onload=async function(g){console.log("generating content to clipboard"),e=Ce(m,u.current,ee,ie,E,H,b,ge,R,g.target.result),await navigator.clipboard.writeText(e)},h.readAsArrayBuffer(u.current)}else e&&(console.log("writing content to clipboard"),navigator.clipboard.writeText(e))},xe=()=>{const h=new Blob([e],{type:"text/plain"});k.current!=null&&k.current.length>0&&(URL.revokeObjectURL(k.current),k.current=""),k.current=URL.createObjectURL(h);const g=document.createElement("a");g.download=Rt(m,R),g.href=k.current,g.click(),setTimeout(()=>{k.current&&k.current.length>0&&(URL.revokeObjectURL(k.current),k.current="")},500)},Ye=()=>{if(!e&&u.current){let h=new FileReader;h.onload=function(g){console.log("generating content to file"),e=Ce(m,u.current,ee,ie,E,H,b,ge,R,g.target.result),xe()},h.readAsArrayBuffer(u.current)}else e&&(console.log("writing content to file"),xe())},et=()=>{setTimeout(function(){try{URL.revokeObjectURL(document.getElementById("picture").src)}catch{console.log("couldn't revoke url")}},1e3)},tt=(h,g,p,w,$,N)=>{let v=0,T=0;for(let F=0;F<p.length;++F)if(p.charCodeAt(F)===13)v=0;else if(p.charCodeAt(F)===10)T+=g.lineHeight,v=0;else{const L=p.charCodeAt(F),V=kt(g,L,N);if(V&&V.width){const q=new Uint8ClampedArray(V.data),te=new ImageData(q,V.width,V.height);h.putImageData(te,v+w,T+$),v+=V.width}else v+=g.width}},rt=(h,g,p,w,$,N)=>{let v=0,T=0;for(const F of Lt(p))if(F===13)v=0;else if(F===10)T+=g.lineHeight,v=0;else{const L=Tt(g,F,N);if(L&&L.width){const V=new Uint8ClampedArray(L.data),q=new ImageData(V,L.width,L.height);h.putImageData(q,v+w+L.offset.x,T+$+L.offset.y),v+=L.advWidth}else v+=g.spaceWidth}},M=()=>{if(!u.current||!_.current){console.log("No gen info");return}let h=_.current;const g=u.current;if(l||(l=H),d||(d=b),f||(f=ie),a||(a=_e),c||(c=E),t||(R?t=R:t="C"),re(g))if(C(u.current,".tvg")){_t("tinyvg",h);const p=document.getElementById("tinyvg");pe(h,!1).then(w=>{n=w,fe(n);let $=n.width,N=n.height;p.style=`width: ${$}px; height: ${N}px`})}else if(C(u.current,".svg")){const p=document.getElementById("svgContainer");if(!p)console.log("Could not find svg container");else{const $=new TextDecoder().decode(h);p.innerHTML=$,pe(h,!0).then(N=>{n=N,fe(n);let v=n.width,T=n.height;p.style=`width: ${v}px; height: ${T}px`,p.lastElementChild.width=v,p.lastElementChild.height=T})}}else{const p=document.getElementById("picture");if(!p)console.log("Could not find picture");else{const w=new Blob([h]),$=URL.createObjectURL(w);p.src=$,pe(h,C(u.current,".svg")).then(N=>{n=N,fe(n);let v=n.width,T=n.height;if(C(u.current,".jpg")&&f&&t&&t.startsWith("G")){const F=Ve({width:v,height:T},f);v=F.width,T=F.height}p.width=v,p.height=T})}}else if(C(u.current,".fon")){let p;const w=document.getElementById("rasterFont");if(!w){console.log("Couldn't find font canvas");return}try{p=Ft(h,c),y(!1),a=xt(p),je(a)}catch{console.log("Couldn't load font"),w.getContext("2d").clearRect(0,0,w.width,w.height),y(!0);return}s=p.lineHeight,J(s),w.width=w.offsetWidth,w.height=w.offsetHeight;const $=w.getContext("2d");$.clearRect(0,0,w.width,w.height),tt($,p,`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`,0,0,4279234815)}else if(C(u.current,".vlw")){const p=St(h);s=p.lineHeight,J(s),a=Nt(p),je(a);const w=document.getElementById("rasterFont");if(!w)console.log("Couldn't find font canvas");else{w.width=w.offsetWidth,w.height=w.offsetHeight;const $=w.getContext("2d");$.clearRect(0,0,w.width,w.height),rt($,p,`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`,0,0,4279234815)}}else if(X(u.current)){const p=document.getElementById("vectorFont");if(!p)console.log("Couldn't find font container");else{const w=new Blob([h]);o||(o=m),o||(o=Le(u.current));const $=URL.createObjectURL(w),N=new FontFace(o,`url(${$})`);N.load().then(()=>{document.fonts.add(N),URL.revokeObjectURL($);let v=l,T=d;(!t.startsWith("G")||!Ie(v,T))&&(v=2,T="em"),p.innerHTML=`<pre style="font: ${v}${T} ${o}; color: #FF0FF0;">`+`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`.replace(/[\u00A0-\u9999<>\&]/g,F=>"&#"+F.charCodeAt(0)+";")+"</pre>"})}}},nt=h=>{h.preventDefault();const g=document.getElementById("file");g.files=h.dataTransfer.files;const p=Fe(h.dataTransfer.files[0]);if(re(p)||Ge(p)){if(_.current){M();return}let w=new FileReader;w.onload=async function($){_.current=$.target.result,M()},w.readAsArrayBuffer(h.dataTransfer.files[0])}};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{id:"drop-target",onDrop:nt,className:"border-drag",onDragOver:h=>h.preventDefault(),children:[!u.current&&i.jsx("p",{children:"Select or drag a file here"}),i.jsx("div",{className:"input-group",children:i.jsx("table",{border:"0",children:i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsx("td",{colSpan:2,children:i.jsx("input",{id:"file",type:"file",onChange:Pe})})}),u.current&&i.jsxs(i.Fragment,{children:[i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("label",{children:"Output:"})}),i.jsx("td",{children:i.jsxs("select",{id:"output",defaultValue:R,onChange:Qe,children:[i.jsx("option",{value:"C",children:"Raw C/++"}),i.jsx("option",{value:"GFX2",children:"GFX 2.x"})]})})]}),i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("label",{children:"Identifier: "})}),i.jsx("td",{children:i.jsx("input",{type:"text",id:"identifier",value:m,onChange:De})})]}),C(u.current,".fon")&&R.startsWith("G")&&i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("label",{children:"Set Index: "})}),i.jsx("td",{children:i.jsx("input",{type:"text",onChange:Me})})]}),X(u.current)&&R.startsWith("G")&&i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("label",{children:"Size: "})}),i.jsxs("td",{children:[i.jsx("input",{type:"text",onChange:Ze}),i.jsxs("select",{onChange:Je,children:[i.jsx("option",{value:"none",children:"none"}),i.jsx("option",{value:"em",children:"em"}),i.jsx("option",{value:"px",children:"px"})]})]})]}),Gt(u.current,H,b)&&R.startsWith("G")&&i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("label",{children:"Stream: "})}),i.jsx("td",{children:i.jsx("input",{type:"checkbox",onChange:Xe})})]}),u.current.type=="image/jpeg"&&R.startsWith("G")&&i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("label",{children:"Scale: "})}),i.jsx("td",{children:i.jsxs("select",{onChange:Be,children:[i.jsx("option",{value:"scale_1_1",children:"1:1"}),i.jsx("option",{value:"scale_1_2",children:"1:2"}),i.jsx("option",{value:"scale_1_4",children:"1:4"}),i.jsx("option",{value:"scale_1_8",children:"1:8"})]})})]})]})]})})}),u.current&&i.jsxs("section",{children:["File details:",i.jsxs("ul",{children:[u.current.type&&i.jsxs("li",{children:["MIME: ",i.jsx("span",{className:"fileType",children:u.current.type})]}),re(u.current)&&ee&&i.jsxs("li",{children:["Dimensions: ",i.jsxs("span",{className:"fileDim",children:[ee.width,"x",ee.height]})]}),Re(u.current)&&Z>0&&i.jsxs("li",{children:["Line Height: ",i.jsx("span",{className:"fontHeight",children:Z})]}),Re(u.current)&&i.jsxs("li",{children:["Glyph Count: ",i.jsx("span",{className:"fontGlyphCount",children:_e})]}),i.jsxs("li",{children:["Size: ",i.jsxs("span",{className:"fileSize",children:[u.current.size," bytes"]})]}),i.jsxs("li",{children:["Type: ",i.jsx("span",{className:"genType",children:qe()})]})]})]}),u.current&&i.jsxs(i.Fragment,{children:[ve(m)&&(!C(u.current,".fon")||P===!1)&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:Ye,className:"submit",children:"Download header file"}),i.jsx("br",{}),i.jsx("button",{onClick:Ke,className:"submit",children:"Copy to clipboard"})]}),!ve(m)&&i.jsx(i.Fragment,{children:i.jsx("span",{style:{color:"red"},children:"Error: Invalid identifier"})}),C(u.current,".fon")&&P&&i.jsx(i.Fragment,{children:i.jsx("span",{style:{color:"red"},children:"Error: Invalid font index"})})]})]}),i.jsx("br",{}),u.current&&i.jsx(i.Fragment,{children:i.jsx("h4",{children:"Preview"})})&&i.jsxs(i.Fragment,{children:[ve(m)&&i.jsx(we,{style:U,language:Ot(R),children:Ce(m,u.current,ee,ie,E,H,b,ge,R,void 0)}),C(u.current,".tvg")&&i.jsx("svg",{id:"tinyvg",xmlns:"http://www.w3.org/2000/svg"}),!C(u.current,".tvg")&&!C(u.current,".svg")&&re(u.current)&&i.jsx("img",{id:"picture",onLoad:et()}),C(u.current,".svg")&&re(u.current)&&i.jsx("div",{id:"svgContainer"}),(C(u.current,".fon")||C(u.current,".vlw"))&&i.jsx("canvas",{id:"rasterFont",width:800,height:300,style:{width:"%100",height:"100%"}}),X(u.current)&&i.jsx("span",{id:"vectorFont",style:{width:"800px",height:"300px"}})]})]})};export{It as default};
