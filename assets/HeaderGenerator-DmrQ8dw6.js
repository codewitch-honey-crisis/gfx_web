import{r as R,j as a}from"./main-BxNYMaPV.js";import{S as we,c as st,a as ot,b as Ae,d as ke,g as Se,e as Ue,t as it}from"./CGen-9Kf1BYQT.js";const at=(e,t)=>({data:e,view:new DataView(e),cursor:0,scale:0,color_encoding:0,coord_range:0,width:0,height:0,colors_size:0,colors:[],doc:document.getElementById(t),elem:void 0,gradIndex:0}),lt=(e,t)=>{const r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)},ct=e=>{let t=e;switch(e.coord_range&&(t=e.range),t){case 0:return 2;case 1:return 1;case 2:return 4}},ce=(e,t)=>{let r=e;if(e.coord_range&&(r=e.range),t==0){switch(r){case 0:return 65535;case 1:return 255;case 2:return 4294967295}return}return t},Ne=(e,t,r)=>{const n=new DataView(r);switch(e){case 0:return n.getUint16(t,!0);case 1:return n.getUint8(t);case 2:return n.getUint32(t,!0)}},be=e=>{let t;switch(e.coord_range){case 0:t=e.view.getUint16(e.cursor,!0),e.cursor+=2;break;case 1:t=e.view.getUint8(e.cursor),e.cursor+=1;break;case 2:t=e.view.getUint32(e.cursor,!0),e.cursor+=4;break}return t},Z=e=>{let t=0,r=0,n;for(;;){n=e.view.getUint8(e.cursor++);const s=(n&127)<<7*t;if(r|=s,(n&128)===0)break;++t}return r},dt=(e,t)=>{const r=1<<e.scale;return t/r},W=e=>{const t=be(e);return dt(e,t)},x=e=>{const t=W(e),r=W(e);return{x:t,y:r}},ut=e=>{switch(e.color_encoding){case 2:{const t=[];return t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,t.push(e.view.getFloat32(e.cursor,!0)),e.cursor+=4,{r:t[0],g:t[1],b:t[2],a:t[3]}}case 1:{const t=e.view.getUint16(e.cursor,!0);return e.cursor+=2,{r:(t&31)/15,g:(t>>>5&63)/31,b:(t>>>11&31)/15,a:1}}case 0:{const t=[];return t.push(e.view.getUint8(e.cursor++)),t.push(e.view.getUint8(e.cursor++)),t.push(e.view.getUint8(e.cursor++)),t.push(e.view.getUint8(e.cursor++)),{r:t[0]/255,g:t[1]/255,b:t[2]/255,a:t[3]/255}}case 3:throw new Error("TinyVG: Custom color table not supported");default:throw new Error("TinyVG: Invalid color format")}},Te=e=>{const t=x(e),r=x(e),n=Z(e),s=Z(e);return{point0:t,point1:r,color0:n,color1:s}},de=(e,t)=>{switch(t){case 0:return{kind:t,flat:Z(e)};case 1:return{kind:t,linear:Te(e)};case 2:return{kind:t,radial:Te(e)};default:throw new Error("TinyVG: Invalid format parsing style")}},ye=(e,t)=>{const n=Z(e)+1,s=de(e,t);return{size:n,style:s}},ae=(e,t)=>{const n=Z(e)+1,s=de(e,t),o=W(e);return{size:n,style:s,line_width:o}},me=(e,t)=>{let r=e.view.getUint8(e.cursor++);const n=(r&63)+1,s=de(e,t),o=de(e,r>>>6&3),l=W(e);return{size:n,fill_style:s,line_style:o,line_width:l}},se=(e,t)=>{let r,n,s,o,l="";s=x(e),l+=`M${s.x} ${s.y}`,r=s,n=s;for(let c=0;c<t;++c)switch(o=e.view.getUint8(e.cursor++),(o>>>4&1)!==0&&W(e),o&7){case 0:s=x(e),l+=` L${s.x} ${s.y}`,n=s;break;case 1:s.x=W(e),s.y=n.y,l+=` H${s.x}`,n=s;break;case 2:s.x=n.x,s.y=W(e),l+=` V${s.y}`,n=s;break;case 3:{const d=x(e),f=x(e),i=x(e);l+=` C${d.x} ${d.y} ${f.x} ${f.y} ${i.x} ${i.y}`,n=i}break;case 4:{o=e.view.getUint8(e.cursor++);const d=W(e);s=x(e),l+=` A${d} ${d} 0 ${o&1} ${1-(o>>>1&1)} ${s.x} ${s.y}`,n=s}break;case 5:{o=e.view.getUint8(e.cursor++);const d=W(e),f=W(e),i=W(e);s=x(e),l+=` A${d} ${f} ${i} ${o&1} ${1-(o>>>1&1)} ${s.x} ${s.y}`,n=s}break;case 6:l+=" Z",n=r;break;case 7:{const d=x(e),f=x(e);l+=` Q${d.x} ${d.y} ${f.x} ${f.y}`,n=f}break;default:throw new Error("TinyVG: Unrecognized command parsing path")}return l},ue=e=>{const t=x(e),r=W(e),n=W(e);return{x:t.x,y:t.y,width:r,height:n}},le=e=>{let t=e.toString(16);return t.length===1?"0"+t:t},ie=e=>({color:`#${le(e.r*255)}${le(e.g*255)}${le(e.b*255)}`,opacity:e.a}),S=(e,t)=>{if(e=document.createElementNS("http://www.w3.org/2000/svg",e),t)for(let r in t)e.setAttributeNS(null,r.replace(/[A-Z]/g,function(n,s,o,l){return"-"+n.toLowerCase()}),t[r]);return e},U=(e,t,r)=>{e.setAttributeNS(null,t,r)},ht=(e,t)=>{let r=e.doc.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs"),n;if(r.length==0?(n=S("defs"),e.doc.prepend(n)):n=r[0],t.kind===1){const s=S("linearGradient",{id:`TvgGradient${e.gradIndex+1}`,x1:t.linear.point0.x,y1:t.linear.point0.y,x2:t.linear.point1.x,y2:t.linear.point1.y});s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"spreadMethod","pad");let o=ie(e.colors[t.linear.color0]);const l=S("stop",{offset:"0%",stopColor:o.color});s.appendChild(l),o=ie(e.colors[t.linear.color1]);const c=S("stop",{offset:"100%",stopColor:o.color});return s.appendChild(c),n.appendChild(s),++e.gradIndex,s.getAttributeNS(null,"id")}else if(t.kind===2){const s=lt(t.radial.point0,t.radial.point1),o=S("radialGradient",{id:`TvgGradient${e.gradIndex+1}`,cx:t.radial.point0.x,cy:t.radial.point0.y,fx:t.radial.point0.x,fy:t.radial.point0.y,r:s});o.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),o.setAttributeNS(null,"spreadMethod","pad");let l=ie(e.colors[t.radial.color0]);const c=S("stop",{offset:"0%",stopColor:l.color,stopOpacity:l.opacity});o.appendChild(c),l=ie(e.colors[t.radial.color1]);const d=S("stop",{offset:"100%",stopColor:l.color,stopOpacity:l.opacity});return o.appendChild(d),n.appendChild(o),++e.gradIndex,o.getAttributeNS(null,"id")}else throw t.kind===0?new Error("TinyVG: attempt to pass flat style to create gradient"):new Error("TinyVG: attempt to pass an invalid style to create gradient")},H=(e,t,r)=>{if(t.kind===0){const n=ie(e.colors[t.flat]);r?(U(e.elem,"fill",n.color),U(e.elem,"fill-opacity",n.opacity)):(U(e.elem,"stroke",n.color),U(e.elem,"stroke-opacity",n.opacity))}else if(t.kind===1||t.kind===2){const n=ht(e,t);r?U(e.elem,"fill",`url(#${n})`):U(e.elem,"stroke",`url(#${n})`)}else throw new Error("TinyVG: attempt to apply invalid style")},ft=(e,t,r)=>{let n=t;if(n===0)throw new Error("TinyVG: Invalid zero length filled rectangles entry");let s=ue(e),o=S("rect",s);e.doc.appendChild(o),e.elem=o,U(e.elem,"fill-rule","evenodd"),H(e,r,!0);const l={};for(l.fillRule="evenodd",r.kind!==0?l.fill=o.getAttributeNS(null,"fill"):(l.fill=o.getAttributeNS(null,"fill"),l.fillOpacity=o.getAttributeNS(null,"fill-opacity")),--n;n--;){s=ue(e);const c={...l,...s};o=S("rect",c),e.doc.appendChild(o),e.elem=o}},gt=(e,t,r,n,s)=>{let o=t;if(o===0)throw new Error("TinyVG: Invalid zero length line filled rectangles entry");s===0&&(s=.001);let l=ue(e),c=S("rect",l);e.doc.appendChild(c),e.elem=c,U(e.elem,"fill-rule","evenodd"),U(e.elem,"stroke-width",s),H(e,r,!0),H(e,n,!1);const d={};for(d.fillRule="evenodd",r.kind!==0?d.fill=c.getAttributeNS(null,"fill"):(d.fill=c.getAttributeNS(null,"fill"),d.fillOpacity=c.getAttributeNS(null,"fill-opacity")),n.kind!==0?d.stroke=c.getAttributeNS(null,"stroke"):(d.stroke=c.getAttributeNS(null,"stroke"),d.strokeOpacity=c.getAttributeNS(null,"stroke-opacity")),d.strokeWidth=s,--o;o--;){l=ue(e);const f={...d,...l};c=S("rect",f),e.doc.appendChild(c),e.elem=c}},pt=(e,t,r)=>{if(t===0)throw new Error("TinyVG: Invalid zero filled paths entry");const n={};n.fillRule="evenodd",n.strokeOpacity=0,n.strokeWidth=0;const s=[];for(let c=0;c<t;++c)s.push(Z(e)+1);let o=S("path",n);e.doc.appendChild(o),e.elem=o,H(e,r,!0),r.kind!==0?n.fill=o.getAttributeNS(null,"fill"):(n.fill=o.getAttributeNS(null,"fill"),n.fillOpacity=o.getAttributeNS(null,"fill-opacity"));let l=se(e,s[0]);for(let c=1;c<t;++c)l+=` ${se(e,s[c])}`;U(o,"d",l)},wt=(e,t,r,n)=>{if(t===0)throw new Error("TinyVG: Invalid zero line paths entry");n===0&&(n=.001);const s={},o=[];for(let d=0;d<t;++d)o.push(Z(e)+1);let l=S("path",s);e.doc.appendChild(l),e.elem=l,U(e.elem,"fill-opacity",0),U(e.elem,"stroke-width",n),H(e,r,!1),r.kind!==0?s.stroke=l.getAttributeNS(null,"stroke"):(s.stroke=l.getAttributeNS(null,"stroke"),s.strokeOpacity=l.getAttributeNS(null,"stroke-opacity")),s.strokeWidth=n,s.fillOpacity=0;let c=se(e,o[0]);for(let d=1;d<t;++d)c+=` ${se(e,o[d])}`;U(l,"d",c)},yt=(e,t,r,n,s)=>{if(t===0)throw new Error("TinyVG: Invalid zero line filled paths entry");s===0&&(s=.001);const o={};o.fillRule="evenodd";const l=[];for(let f=0;f<t;++f)l.push(Z(e)+1);let c=S("path",o);e.doc.appendChild(c),e.elem=c,H(e,r,!0),r.kind!==0?o.fill=c.getAttributeNS(null,"fill"):(o.fill=c.getAttributeNS(null,"fill"),o.fillOpacity=c.getAttributeNS(null,"fill-opacity")),H(e,n,!1),n.kind!==0?o.stroke=c.getAttributeNS(null,"stroke"):(o.stroke=c.getAttributeNS(null,"stroke"),o.strokeOpacity=c.getAttributeNS(null,"stroke-opacity")),o.strokeWidth=s,U(c,"stroke-width",s);let d=se(e,l[0]);for(let f=1;f<t;++f)d+=` ${se(e,l[f])}`;U(c,"d",d)},mt=(e,t,r)=>{if(t===0)throw new Error("TinyVG: Invalid zero polygon entry");let n=t,s="",o=x(e);for(s+=`${o.x},${o.y}`;--n;)o=x(e),s+=` ${o.x},${o.y}`;let c=S("polygon",{fillRule:"evenodd",points:s});e.doc.appendChild(c),e.elem=c,H(e,r,!0)},Ee=(e,t,r,n,s)=>{if(t===0)throw new Error("TinyVG: Invalid zero polyline entry");n===0&&(n=.001);let o=t,l="",c=x(e);for(l+=`${c.x},${c.y}`;--o;)c=x(e),l+=` ${c.x},${c.y}`;let f=S(s?"polygon":"polyline",{points:l,lineWidth:n,fillOpacity:0});e.doc.appendChild(f),e.elem=f,H(e,r,!1)},vt=(e,t,r,n,s,o)=>{if(t===0)throw new Error("TinyVG: Invalid zero line fill polyline entry");s===0&&(s=.001);let l=t,c="",d=x(e);for(c+=`${d.x},${d.y}`;--l;)d=x(e),c+=` ${d.x},${d.y}`;let i=S("polygon",{points:c,lineWidth:s,fillRule:"evenodd"});e.doc.appendChild(i),e.elem=i,H(e,r,!0),H(e,n,!1)},Ct=(e,t,r,n)=>{if(t===0)throw new Error("TinyVG: Invalid zero lines entry");for(let s=0;s<t;++s){const o=x(e),l=x(e),c={x1:o.x,y1:o.y,x2:l.x,y2:l.y,strokeWidth:n};let d=S("line",c);e.doc.appendChild(d),e.elem=d,H(e,r,!1)}},bt=e=>{let t=255;for(;t!=0;)switch(t=e.view.getUint8(e.cursor++),t&63){case 0:break;case 1:{const r=ye(e,t>>>6&3);mt(e,r.size,r.style)}break;case 2:{const r=ye(e,t>>>6&3);ft(e,r.size,r.style)}break;case 3:{const r=ye(e,t>>>6&3);pt(e,r.size,r.style)}break;case 4:{const r=ae(e,t>>>6&3);Ct(e,r.size,r.style,r.line_width)}break;case 5:{const r=ae(e,t>>>6&3);Ee(e,r.size,r.style,r.line_width,!0)}break;case 6:{const r=ae(e,t>>>6&3);Ee(e,r.size,r.style,r.line_width,!1)}break;case 7:{const r=ae(e,t>>>6&3);wt(e,r.size,r.style,r.line_width)}break;case 8:{const r=me(e,t>>>6&3);vt(e,r.size,r.fill_style,r.line_style,r.line_width)}break;case 9:{const r=me(e,t>>>6&3);gt(e,r.size,r.fill_style,r.line_style,r.line_width)}break;case 10:{const r=me(e,t>>>6&3);yt(e,r.size,r.fill_style,r.line_style,r.line_width)}break;default:throw new Error(`TinyVG: Invalid command in document (0x${le(t)})`)}},$t=e=>{if(e){const t=new DataView(e);if(t.byteLength>5&&t.getUint8(0)==114&&t.getUint8(1)==86&&t.getUint8(2)==1){const n=t.getUint8(3)>>>6&3,s=Ne(n,4,e),o=Ne(n,4+ct(n),e);return{width:ce(n,s),height:ce(n,o)}}}},_t=(e,t)=>{if(!t)throw new Error("TinyVG: Must provide an ArrayBuffer with TVG data");const r=new DataView(t);if(r.byteLength>5&&r.getUint8(0)==114&&r.getUint8(1)==86&&r.getUint8(2)==1){const n=at(t,e);if(n.doc){const s=r.getUint8(3);n.scale=s&15,n.color_encoding=s>>>4&3,n.coord_range=s>>>6&3,n.cursor=4;const o=be(n),l=be(n);n.width=ce(n,o),n.height=ce(n,l);const c=Z(n);if(!c||c===0)throw new Error("TinyVG: invalid format - color table contains nothing");for(let d=0;d<c;++d)n.colors.push(ut(n));for(;n.doc.firstChild;)n.doc.removeChild(n.doc.lastChild);U(n.doc,"width",o.toString(10)),U(n.doc,"height",l.toString(10)),U(n.doc,"viewBox",`0 0 ${o} ${l}`),bt(n);return}}throw new Error("TinyVG: Not a valid TinyVG file")},K=e=>{const t=e.view.getUint8(e.dataCursor);return e.dataCursor+=1,t},M=e=>{const t=e.view.getUint16(e.dataCursor,!0);return e.dataCursor+=2,t},Oe=e=>{const t=e.view.getUint32(e.dataCursor,!0);return e.dataCursor+=4,t},jt=(e,t)=>{if(e.charTableOffset===0)throw new Error("Fon: Not initialized");if(t<e.firstCharCode||t>e.lastCharCode)throw new Error("Fon: Character not found");const r=e.charTableOffset+e.charTableLength*(t-e.firstCharCode);e.dataCursor=r+e.fontOffset},Ft=(e,t=0)=>{const r={data:e,view:new DataView(e),fontIndex:t,lineHeight:0,width:0,fontOffset:-1,charTableOffset:-1,charTableLength:0,firstCharCode:0,lastCharCode:0,dataCursor:0};let n=!1;if(K(r)===77&&K(r)===90&&(n=!0),n){r.dataCursor=60;const l=Oe(r);if(r.dataCursor=l,K(r)===78&&K(r)===69){r.dataCursor=l+36;const d=M(r)+l;r.dataCursor=d;const f=M(r);let i=0;for(;r.fontOffset<0;){const N=M(r);if(N===0)break;const $=M(r);r.dataCursor+=4;for(let u=0;u<$;++u){const C=M(r)<<f;if(r.dataCursor+=2,N===32776){if(i===r.fontIndex){r.fontOffset=C;break}++i}if(r.fontOffset>-1)break;r.dataCursor+=8}}if(r.fontOffset<0)throw new Error("Fon: Font index out of range")}else throw new Error("Fon: Not a 16-bit Windows 3.1 Font. Might be a 32-bit font, which is not supported")}r.dataCursor=r.fontOffset;const s=M(r);if(r.dataCursor=r.fontOffset+66,M(r)&1)throw new Error("Fon: Vector fonts are not supported");return r.dataCursor=r.fontOffset+88,r.lineHeight=M(r),s==512?(r.charTableOffset=118,r.charTableLength=4):(r.charTableOffset=148,r.charTableLength=6),r.dataCursor=r.fontOffset+95,r.firstCharCode=K(r),r.lastCharCode=K(r),r},xt=e=>e.lastCharCode-e.firstCharCode+1,At=(e,t,r)=>{jt(e,t);const n=M(e),s=n*e.lineHeight,o=new ArrayBuffer(s*4),l=new DataView(o),c=Math.floor((n+7)/8);let d;e.charTableLength===4?d=M(e):d=Oe(e);let f=0;for(let i=0;i<e.lineHeight;++i){let N=0;for(let C=0;C<c;++C){const A=d+C*e.lineHeight+i;e.dataCursor=A+e.fontOffset,N<<=8,N|=K(e)}const $=c*8-n;N>>>=$;const u=1<<n-1;for(let C=0;C<n;++C)(N&u)!==0?l.setUint32(f,r):l.setUint32(f,0),f+=4,N<<=1}return{width:n,height:e.lineHeight,data:o}},kt=e=>{const t=e.view.getUint8(e.dataCursor);return e.dataCursor+=1,t},D=e=>{const t=e.view.getUint32(e.dataCursor,!1);return e.dataCursor+=4,t},he=e=>{const t=e.view.getInt32(e.dataCursor,!1);return e.dataCursor+=4,t},St=e=>{const t={data:e,view:new DataView(e),glyphCount:0,lineAdvance:0,lineHeight:0,ascent:0,descent:0,spaceWidth:0,dataCursor:0};t.glyphCount=D(t),t.dataCursor+=4,t.lineAdvance=D(t),t.dataCursor+=4,t.ascent=he(t),t.descent=he(t),t.spaceWidth=(t.ascent+t.descent)*Math.floor(2/7),t.dataCursor=24;let r=0;for(;r++<t.glyphCount;){const n=D(t);if(n>32&&n<160&&n!=127||n>255){const s=D(t);t.dataCursor+=12,s>t.lineHeight&&(t.lineHeight=s),t.dataCursor+=8}else t.dataCursor+=24}return t},Ut=(e,t)=>{let r=0;for(e.dataCursor=24;r<e.glyphCount;){if(D(e)===t)return e.dataCursor-=4,r;e.dataCursor+=24,++r}return-1},Nt=e=>e.glyphCount,Tt=(e,t,r)=>{if(t>32&&t<160&&t!=127||t>255){if(Ut(e,t)<0){const j=e.spaceWidth,y=e.spaceWidth,k=j*e.lineHeight,T=new ArrayBuffer(k*4);return{width:j,height:e.lineHeight,advWidth:y,offset:{x:0,y:0},data:T}}e.dataCursor+=4;const n=D(e),s=D(e),o=D(e),l=e.lineAdvance-he(e),c=he(e),d=s*n,f=new ArrayBuffer(d*4),i=new DataView(f);let N=24+e.glyphCount*28,$=0;e.dataCursor=24;let u=0,C,A;for(;$<e.glyphCount;){const j=D(e),y=24+$*28;if(e.dataCursor=y+4,A=D(e),C=D(e),j===t){u=N;break}else u+=C*A;N+=C*A,e.dataCursor+=16,++$}if($>=e.glyphCount){const j=e.spaceWidth,y=e.spaceWidth,k=j*e.lineHeight,T=new ArrayBuffer(k*4);return{width:j,height:e.lineHeight,advWidth:y,offset:{x:0,y:0},data:T}}e.dataCursor=u;const X=(r>>>24&255)/255;$=0;for(let j=0;j<n;++j)for(let y=0;y<s;++y){const k=kt(e);let T;k===0?T=0:T=r&16777215|Math.floor(k*X)<<24,i.setUint32($,T),$+=4}return{width:s,height:n,xOffset:c,advWidth:o,offset:{x:c,y:l},data:f}}else{const n=e.spaceWidth,s=e.spaceWidth,o=n*e.lineHeight,l=new ArrayBuffer(o*4);return{width:n,height:e.lineHeight,advWidth:s,offset:{x:0,y:0},data:l}}},Et=()=>!!(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches),We=e=>e.type.endsWith("/json")||e.type.endsWith("/xml")||e.type.endsWith("+xml")||e.type.startsWith("text/"),Ge=e=>it(e.name),ve=e=>{if(!e||!e.length||e.length===0)return!1;const t=/^[A-Za-z_][A-Za-z0-9_]*$/,r=e.match(t);return r&&r.length>0},v=(e,t)=>e&&e.name&&e.name.toLowerCase().endsWith(t.toLowerCase()),ne=e=>{const t=e.name.toLowerCase(),r=e.type;if(r=="image/jpg"||r=="image/png"||r=="image/svg+xml"||t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".svg")||t.endsWith(".tvg"))return!0},Le=e=>v(e,".vlw")||v(e,".fon")||Q(e),Re=e=>e&&e.name&&v(e,".vlw")||v(e,".fon"),Q=e=>{const t=e.name.toLowerCase();return t.endsWith(".ttf")||t.endsWith(".otf")},Ve=(e,t)=>{let r=1;switch(t){case"scale_1_2":r=.5;break;case"scale_1_4":r=.25;break;case"scale_1_8":r=.125;break;default:return e}return{width:Math.ceil(e.width*r),height:Math.ceil(e.height*r)}},Gt=function*(e){for(const t of e){let r=t.codePointAt(0);if(r>=55296&&r<=56319){const n=t.codePointAt(1);if(!(n>=56320&&n<=57343))throw new Error("Unicode stream error. Unterminated high surrogate");const s=r&1023,o=n&1023;r=s<<10|o+65536}yield r}},Ie=(e,t)=>!(!e||isNaN(e)||e===0||!t||t!="px"&&t!="em"),Lt=(e,t,r)=>v(e,".fon")||e.type==="image/jpeg"||e.type==="image/png"||v(e,".vlw")?!0:!!(Q(e)&&Ie(t,r)),Ce=(e,t,r,n,s,o,l,c,d,f)=>{let i="";(n===void 0||n==="")&&(n="scale_1_1");const N=t.type,$=d!=null&&d.length>0&&d!="C",u=e.toUpperCase()+($?"_HPP":"_H"),C=e.toUpperCase()+"_IMPLEMENTATION",A=$?".hpp":".h";i+=`// Automatically generated by https://codewitch-honey-crisis.github.io/gfx_web/header\r
`,i+=`// #define ${C} in exactly one\r
`;let X=".c/.cpp";$&&(X=".cpp"),i+=`// translation unit (${X} file) before including this header\r
`,i+=`\r
// USAGE:\r
`,i+=`#if 0\r
`,i+=`#define ${C}\r
`,i+=`#include "${e}${A}"\r
`,i+=`#undef ${C}\r
`,i+=`// use ${e}\r
`,i+=`#endif\r
`,i+=`#ifndef ${u}\r
`,i+=`#define ${u}\r
`;const j=We(t);($||!j)&&(i+=`#include <stdint.h>\r
`);let y;r&&r.width&&r.height&&r.width>0&&r.height>0&&(y=r);let k=!1,T=!1,oe=!1,Y=!1,J=!1,V=!1,ee=!1,z=!1,_=$?"constant data stream":"constant source data";if(v(t,".fon")?(T=!0,k=T,_="Windows 3.1 raster font"):N==="image/jpeg"?(J=!0,k=!0,_="JPEG image"):N==="image/svg+xml"?(ee=!0,_="Scalable Vector Graphic"):v(t,".tvg")?(z=!0,_="TInyVG binary vector graphic"):N==="image/png"?(V=!0,k=!0,_="PNG image"):v(t,".vlw")?(Y=!0,k=!0,_="Processing antialiased raster font"):Q(t)?(v(".otf")?_="OpenType vector font":_="TrueType vector font",o&&!isNaN(o)&&o!=0&&l&&l!==""&&l!=="none"&&(oe=!0,k=!0)):Q(t)&&(v(".otf")?_="OpenType vector font":_="TrueType vector font"),$){if(T)i+=`#include "gfx_win_font.hpp"\r
\r
`,i+=`/// @brief A ${_}\r
`,i+=`extern gfx::win_font ${e};\r
`;else if(Y)i+=`#include "gfx_vlw_font.hpp"\r
\r
`,i+=`/// @brief A ${_}\r
`,i+=`extern gfx::vlw_font ${e};\r
`;else if(J){if(i+=`#include "gfx_jpg_image.hpp"\r
\r
`,y){const P=Ve(y,n);i+=`#define ${e.toUpperCase()}_DIMENSIONS {${P.width}, ${P.height}}\r
\r
`}i+=`/// @brief A ${_}\r
`,i+=`extern gfx::jpg_image ${e};\r
`}else V?(i+=`#include "gfx_png_image.hpp"\r
\r
`,y&&(i+=`#define ${e.toUpperCase()}_DIMENSIONS {${y.width}, ${y.height}}\r
\r
`),i+=`/// @brief A ${_}\r
`,i+=`extern gfx::png_image ${e};\r
`):oe?(i+=`#include "gfx_ttf_font.hpp"\r
\r
`,i+=`/// @brief A ${_}\r
`,i+=`extern gfx::ttf_font ${e};\r
`):(i+=`#include "gfx_core.hpp"\r
\r
`,(ee||z)&&y&&(i+=`const constexpr gfx::sizef ${e}_dimensions(${y.width}, ${y.height});\r
\r
`),i+=`/// @brief A ${_}\r
`,i+=`extern gfx::const_buffer_stream ${e};\r
`);c&&k&&(i+=`/// @brief A ${_} constant source stream\r
`,i+=`extern gfx::const_buffer_stream ${e}_stream;\r
`)}else if(j){if(f){const P=new DataView(f);i+=`#define ${e.toUpperCase()}_LENGTH (${P.byteLength})\r
`}else i+=`#define ${e.toUpperCase()}_LENGTH (${t.size})\r
`;(ee||z||V||J)&&y&&(i+=`#define ${e.toUpperCase()}_DIMENSIONS {${y.width}, ${y.height}}\r
\r
`),i+=`#ifdef __cplusplus\r
extern "C"\r
#else\r
extern\r
#endif\r
`,i+=`/// @brief A ${_}\r
`,i+=`const char* ${e};\r
`}else(ee||z||V||J)&&y&&(i+=`#define ${e.toUpperCase()}_DIMENSIONS {${y.width}, ${y.height}}\r
\r
`),i+=`#ifdef __cplusplus\r
extern "C"\r
#else\r
extern\r
#endif\r
`,i+=`/// @brief A ${_}\r
`,i+=`const uint8_t ${e}[];\r
`;if(i+=`#endif // ${u}\r
\r
`,i+=`#ifdef ${C}\r
`,$){if(j?i+=Se(e+"_data",f,!0)+`\r
\r
`:i+=Ue(e+"_data",f,!0)+`\r
\r
`,k&&!c&&(i+=`static gfx::const_buffer_stream ${e}_stream\r
    (${e}_data, sizeof(${e}_data));\r
`),T)s&&s!=0?i+=`gfx::win_font ${e}\r
    (${e}_stream, ${s});\r
`:i+=`gfx::win_font ${e}\r
    (${e}_stream);\r
`;else if(Y)i+=`gfx::vlw_font ${e}\r
    (${e}_stream);\r
`;else if(J)n&&n!="scale_1_1"?i+=`gfx::jpg_image ${e}\r
    (${e}_stream, jpg_scale::${n});\r
`:i+=`gfx::jpg_image ${e}\r
    (${e}_stream);\r
`;else if(V)i+=`gfx::png_image ${e}\r
    (${e}_stream);\r
`;else if(oe)i+=`gfx::ttf_font ${e}\r
    (${e}_stream, ${o}, gfx::font_size_units::${l})\r
`;else if(j)if(f){const P=new DataView(f);i+=`gfx::const_buffer_stream ${e}\r
    ((const uint8_t*)${e}_data, ${P.byteLength});\r
`}else i+=`gfx::const_buffer_stream ${e}\r
    ((const uint8_t*)${e}_data, ${t.size});\r
`;else i+=`gfx::const_buffer_stream ${e}\r
    (${e}_data, sizeof(${e}_data));\r
`;k&&c&&(i+=`gfx::const_buffer_stream ${e}_stream\r
    (${e}_data, sizeof(${e}_data));\r
`)}else j?i+=Se(e,f,!1)+`\r
`:i+=Ue(e,f,!1)+`\r
`;return i+=`#endif // ${C}\r
`,i},Rt=(e,t)=>t==="C"||t===void 0||t===""?`${e}.h`:`${e}.hpp`,Ot=e=>e==="C"||e===void 0||e===""?"c":"cpp",It=()=>{we.registerLanguage("c",st),we.registerLanguage("cpp",ot);let e,t,r,n,s,o,l,c,d,f,i;const[N,$]=R.useState(Et()?Ae:ke);R.useEffect(()=>{const h=p=>{$(p.matches?Ae:ke)},g=window.matchMedia("(prefers-color-scheme: dark)");return g.addEventListener("change",h),()=>g.removeEventListener("change",h)},[]);const u=R.useRef(""),C=R.useRef(void 0),A=R.useRef(""),[X,j]=R.useState(!1),[y,k]=R.useState(""),[T,oe]=R.useState(0),[Y,J]=R.useState(0),[V,ee]=R.useState(0),[z,_]=R.useState("none"),[P,$e]=R.useState("scale_1_1"),[te,fe]=R.useState(""),[O,He]=R.useState("C"),[ge,ze]=R.useState(!1),[_e,je]=R.useState(0),Fe=h=>(C.current=void 0,u.current=h,k(Ge(h)),e=void 0,h),Pe=h=>{if(h.target.files.length===0)return;const g=Fe(h.target.files[0]);if(ne(g)||Le(g)){if(C.current){B();return}let p=new FileReader;p.onload=async function(w){C.current=w.target.result,B()},p.readAsArrayBuffer(h.target.files[0])}},De=h=>{y!=h.target.value&&(o=h.target.value,k(o),e=void 0)},Me=h=>{let g;h.target.value.length>0?(g=Number.parseInt(h.target.value),isNaN(g)&&(g=0)):g=0,c=g,j(!1),oe(c),e=void 0,B()},Be=h=>{let g=h.target.value;(g===void 0||g==="")&&(g="scale_1_1"),f=g,$e(g),e=void 0,B()},Ze=h=>{let g=Number.parseFloat(h.target.value);l=g,ee(g),e=void 0,B()},Je=h=>{d=h.target.value,d||(d="none"),_(d),e=void 0,B()},Qe=h=>{t=h.target.value,He(t),f="scale_1_1",$e(f),e=void 0,B()},Xe=h=>{r=h.target.checked,ze(r),e=void 0},pe=async(h,g=!1)=>new Promise((p,w)=>{if(g){const E=new TextDecoder("utf-8").decode(h),F=new DOMParser().parseFromString(E,"image/svg+xml").documentElement;document.body.appendChild(F);let L,I=F.getAttributeNS(null,"width"),q=F.getAttributeNS(null,"height");if(I&&q&&I.length>0&&q.length>0)L={width:Math.ceil(parseFloat(I)),height:Math.ceil(parseFloat(q))};else{const re=F.getBBox();L={width:Math.ceil(re.width+re.x),height:Math.ceil(re.height+re.y)}}document.body.removeChild(F),L&&L.width>0?p(L):w()}else{let b=$t(h);if(b)p(b);else{const E=URL.createObjectURL(new Blob([h])),m=new Image;m.onload=()=>{b={width:m.naturalWidth,height:m.naturalHeight},p(b)},m.src=E}}}),qe=()=>{if(u.current){if(!O||O===""||O==="C")return We(u.current)?"const char*":"const uint8_t[]";const h=u.current.type;u.current.name;const g=V,p=z;return h===void 0||h===""&&v(u.current,".fon")?"gfx::win_font":h==="image/jpeg"?"gfx::jpg_image":h==="image/png"?"gfx::png_image":v(u.current,".vlw")?"gfx::vlw_font":Q(u.current)&&g&&!isNaN(g)&&g!=0&&p?"gfx::ttf_font":"gfx::const_buffer_stream"}},Ke=()=>{if(!e&&u.current){let h=new FileReader;h.onload=async function(g){console.log("generating content to clipboard"),e=Ce(y,u.current,te,P,T,V,z,ge,O,g.target.result),await navigator.clipboard.writeText(e)},h.readAsArrayBuffer(u.current)}else e&&(console.log("writing content to clipboard"),navigator.clipboard.writeText(e))},xe=()=>{const h=new Blob([e],{type:"text/plain"});A.current!=null&&A.current.length>0&&(URL.revokeObjectURL(A.current),A.current=""),A.current=URL.createObjectURL(h);const g=document.createElement("a");g.download=Rt(y,O),g.href=A.current,g.click(),setTimeout(()=>{A.current&&A.current.length>0&&(URL.revokeObjectURL(A.current),A.current="")},500)},Ye=()=>{if(!e&&u.current){let h=new FileReader;h.onload=function(g){console.log("generating content to file"),e=Ce(y,u.current,te,P,T,V,z,ge,O,g.target.result),xe()},h.readAsArrayBuffer(u.current)}else e&&(console.log("writing content to file"),xe())},et=()=>{setTimeout(function(){try{URL.revokeObjectURL(document.getElementById("picture").src)}catch{console.log("couldn't revoke url")}},1e3)},tt=(h,g,p,w,b,E)=>{let m=0,G=0;for(let F=0;F<p.length;++F)if(p.charCodeAt(F)===13)m=0;else if(p.charCodeAt(F)===10)G+=g.lineHeight,m=0;else{const L=p.charCodeAt(F),I=At(g,L,E);if(I&&I.width){const q=new Uint8ClampedArray(I.data),re=new ImageData(q,I.width,I.height);h.putImageData(re,m+w,G+b),m+=I.width}else m+=g.width}},rt=(h,g,p,w,b,E)=>{let m=0,G=0;for(const F of Gt(p))if(F===13)m=0;else if(F===10)G+=g.lineHeight,m=0;else{const L=Tt(g,F,E);if(L&&L.width){const I=new Uint8ClampedArray(L.data),q=new ImageData(I,L.width,L.height);h.putImageData(q,m+w+L.offset.x,G+b+L.offset.y),m+=L.advWidth}else m+=g.spaceWidth}},B=()=>{if(!u.current||!C.current){console.log("No gen info");return}let h=C.current;const g=u.current;if(l||(l=V),d||(d=z),f||(f=P),i||(i=_e),c||(c=T),t||(O?t=O:t="C"),ne(g))if(v(u.current,".tvg")){_t("tinyvg",h);const p=document.getElementById("tinyvg");pe(h,!1).then(w=>{n=w,fe(n);let b=n.width,E=n.height;p.style=`width: ${b}px; height: ${E}px`})}else if(v(u.current,".svg")){const p=document.getElementById("svgContainer");if(!p)console.log("Could not find svg container");else{const b=new TextDecoder().decode(h);p.innerHTML=b,pe(h,!0).then(E=>{n=E,fe(n);let m=n.width,G=n.height;p.style=`width: ${m}px; height: ${G}px`,p.lastElementChild.width=m,p.lastElementChild.height=G})}}else{const p=document.getElementById("picture");if(!p)console.log("Could not find picture");else{const w=new Blob([h]),b=URL.createObjectURL(w);p.src=b,pe(h,v(u.current,".svg")).then(E=>{n=E,fe(n);let m=n.width,G=n.height;if(v(u.current,".jpg")&&f&&t&&t.startsWith("G")){const F=Ve({width:m,height:G},f);m=F.width,G=F.height}p.width=m,p.height=G})}}else if(v(u.current,".fon")){let p;const w=document.getElementById("rasterFont");if(!w){console.log("Couldn't find font canvas");return}try{p=Ft(h,c),j(!1),i=xt(p),je(i)}catch{console.log("Couldn't load font"),w.getContext("2d").clearRect(0,0,w.width,w.height),j(!0);return}s=p.lineHeight,J(s),w.width=w.offsetWidth,w.height=w.offsetHeight;const b=w.getContext("2d");b.clearRect(0,0,w.width,w.height),tt(b,p,`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`,0,0,4279234815)}else if(v(u.current,".vlw")){const p=St(h);s=p.lineHeight,J(s),i=Nt(p),je(i);const w=document.getElementById("rasterFont");if(!w)console.log("Couldn't find font canvas");else{w.width=w.offsetWidth,w.height=w.offsetHeight;const b=w.getContext("2d");b.clearRect(0,0,w.width,w.height),rt(b,p,`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`,0,0,4279234815)}}else if(Q(u.current)){const p=document.getElementById("vectorFont");if(!p)console.log("Couldn't find font container");else{const w=new Blob([h]);o||(o=y),o||(o=Ge(u.current));const b=URL.createObjectURL(w),E=new FontFace(o,`url(${b})`);E.load().then(()=>{document.fonts.add(E),URL.revokeObjectURL(b);let m=l,G=d;(!t.startsWith("G")||!Ie(m,G))&&(m=2,G="em"),p.innerHTML=`<pre style="font: ${m}${G} ${o}; color: #FF0FF0;">`+`0123456789/\\.,_-+()[]{}$%?
ABCDEFGHIJKLMNOPQRSTUVWXYZ
abcdefghijklmnopqrstuvwxyz`.replace(/[\u00A0-\u9999<>\&]/g,F=>"&#"+F.charCodeAt(0)+";")+"</pre>"})}}},nt=h=>{h.preventDefault();const g=document.getElementById("file");g.files=h.dataTransfer.files;const p=Fe(h.dataTransfer.files[0]);if(ne(p)||Le(p)){if(C.current){B();return}let w=new FileReader;w.onload=async function(b){C.current=b.target.result,B()},w.readAsArrayBuffer(h.dataTransfer.files[0])}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{id:"drop-target",onDrop:nt,className:"border-drag",onDragOver:h=>h.preventDefault(),children:[!u.current&&a.jsx("p",{children:"Select or drag a file here"}),a.jsx("div",{className:"input-group",children:a.jsx("table",{border:"0",children:a.jsxs("tbody",{children:[a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx("input",{id:"file",type:"file",onChange:Pe})})}),u.current&&a.jsxs(a.Fragment,{children:[a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("label",{children:"Output:"})}),a.jsx("td",{children:a.jsxs("select",{id:"output",defaultValue:O,onChange:Qe,children:[a.jsx("option",{value:"C",children:"Raw C/++"}),a.jsx("option",{value:"GFX2",children:"GFX 2.x"})]})})]}),a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("label",{children:"Identifier: "})}),a.jsx("td",{children:a.jsx("input",{type:"text",id:"identifier",value:y,onChange:De})})]}),v(u.current,".fon")&&O.startsWith("G")&&a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("label",{children:"Set Index: "})}),a.jsx("td",{children:a.jsx("input",{type:"text",onChange:Me})})]}),Q(u.current)&&O.startsWith("G")&&a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("label",{children:"Size: "})}),a.jsxs("td",{children:[a.jsx("input",{type:"text",onChange:Ze}),a.jsxs("select",{onChange:Je,children:[a.jsx("option",{value:"none",children:"none"}),a.jsx("option",{value:"em",children:"em"}),a.jsx("option",{value:"px",children:"px"})]})]})]}),Lt(u.current,V,z)&&O.startsWith("G")&&a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("label",{children:"Stream: "})}),a.jsx("td",{children:a.jsx("input",{type:"checkbox",onChange:Xe})})]}),u.current.type=="image/jpeg"&&O.startsWith("G")&&a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("label",{children:"Scale: "})}),a.jsx("td",{children:a.jsxs("select",{onChange:Be,children:[a.jsx("option",{value:"scale_1_1",children:"1:1"}),a.jsx("option",{value:"scale_1_2",children:"1:2"}),a.jsx("option",{value:"scale_1_4",children:"1:4"}),a.jsx("option",{value:"scale_1_8",children:"1:8"})]})})]})]})]})})}),u.current&&a.jsxs("section",{children:["File details:",a.jsxs("ul",{children:[u.current.type&&a.jsxs("li",{children:["MIME: ",a.jsx("span",{className:"fileType",children:u.current.type})]}),ne(u.current)&&te&&a.jsxs("li",{children:["Dimensions: ",a.jsxs("span",{className:"fileDim",children:[te.width,"x",te.height]})]}),Re(u.current)&&Y>0&&a.jsxs("li",{children:["Line Height: ",a.jsx("span",{className:"fontHeight",children:Y})]}),Re(u.current)&&a.jsxs("li",{children:["Glyph Count: ",a.jsx("span",{className:"fontGlyphCount",children:_e})]}),a.jsxs("li",{children:["Size: ",a.jsxs("span",{className:"fileSize",children:[u.current.size," bytes"]})]}),a.jsxs("li",{children:["Type: ",a.jsx("span",{className:"genType",children:qe()})]})]})]}),u.current&&a.jsxs(a.Fragment,{children:[ve(y)&&(!v(u.current,".fon")||X===!1)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:Ye,className:"submit",children:"Download header file"}),a.jsx("br",{}),a.jsx("button",{onClick:Ke,className:"submit",children:"Copy to clipboard"})]}),!ve(y)&&a.jsx(a.Fragment,{children:a.jsx("span",{style:{color:"red"},children:"Error: Invalid identifier"})}),v(u.current,".fon")&&X&&a.jsx(a.Fragment,{children:a.jsx("span",{style:{color:"red"},children:"Error: Invalid font index"})})]})]}),a.jsx("br",{}),u.current&&a.jsx(a.Fragment,{children:a.jsx("h4",{children:"Preview"})})&&a.jsxs(a.Fragment,{children:[ve(y)&&a.jsx(we,{style:N,language:Ot(O),children:Ce(y,u.current,te,P,T,V,z,ge,O,void 0)}),v(u.current,".tvg")&&a.jsx("svg",{id:"tinyvg",xmlns:"http://www.w3.org/2000/svg"}),!v(u.current,".tvg")&&!v(u.current,".svg")&&ne(u.current)&&a.jsx("img",{id:"picture",onLoad:et()}),v(u.current,".svg")&&ne(u.current)&&a.jsx("div",{id:"svgContainer"}),(v(u.current,".fon")||v(u.current,".vlw"))&&a.jsx("canvas",{id:"rasterFont",width:800,height:300,style:{width:"%100",height:"100%"}}),Q(u.current)&&a.jsx("span",{id:"vectorFont",style:{width:"800px",height:"300px"}})]})]})};export{It as default};
